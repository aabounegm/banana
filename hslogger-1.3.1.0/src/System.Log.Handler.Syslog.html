<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_FHXBSYi5Mxz86czhOz5MfT"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{- |
   Module     : System.Log.Handler.Syslog
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Portability: portable

Syslog handler for the Haskell Logging Framework

Written by John Goerzen, jgoerzen\@complete.org

This module implements an interface to the Syslog service commonly
found in Unix\/Linux systems.  This interface is primarily of interest to
developers of servers, as Syslog does not typically display messages in
an interactive fashion.

This module is written in pure Haskell and is capable of logging to a local
or remote machine using the Syslog protocol.

You can create a new Syslog 'LogHandler' by calling 'openlog'.

More information on the Haskell Logging Framework can be found at
&quot;System.Log.Logger&quot;.  This module can also be used outside
of the rest of that framework for those interested in that.
-}</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Log.Handler.Syslog</span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>                                       </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier">SyslogHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- No constructors.</span><span>
</span><span id="line-31"></span><span>                                       </span><span class="annot"><span class="hs-comment">-- * Handler Initialization</span></span><span>
</span><span id="line-32"></span><span>                                       </span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog"><span class="hs-identifier">openlog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                                       </span><span class="annot"><span class="hs-comment">-- * Advanced handler initialization</span></span><span class="hs-cpp">
#ifndef mingw32_HOST_OS
</span><span>                                       </span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog_local"><span class="hs-identifier">openlog_local</span></a></span><span class="hs-special">,</span><span class="hs-cpp">
#endif
</span><span>                                       </span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog_remote"><span class="hs-identifier">openlog_remote</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>                                       </span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog_generic"><span class="hs-identifier">openlog_generic</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>                                       </span><span class="annot"><span class="hs-comment">-- * Data Types</span></span><span>
</span><span id="line-40"></span><span>                                       </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier">Facility</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>                                       </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Option"><span class="hs-identifier">Option</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>                                       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Log.html"><span class="hs-identifier">System.Log</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Log.Formatter.html"><span class="hs-identifier">System.Log.Formatter</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Log.Handler.html"><span class="hs-identifier">System.Log.Handler</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.Socket</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.Socket.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SBS</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.BSD</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">genericDrop</span></span><span class="hs-special">)</span><span class="hs-cpp">
#ifndef mingw32_HOST_OS
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix.Process</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getProcessID</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="UTF8.html"><span class="hs-identifier">UTF8</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#send"><span class="hs-identifier hs-type">send</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-62"></span><span id="send"><span class="annot"><span class="annottext">send :: Socket -&gt; String -&gt; IO Int
</span><a href="System.Log.Handler.Syslog.html#send"><span class="hs-identifier hs-var hs-var">send</span></a></span></span><span> </span><span id="local-6989586621679051049"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679051049"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Socket -&gt; ByteString -&gt; IO Int
</span><span class="hs-identifier hs-var">SBS.send</span></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679051049"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO Int)
-&gt; (String -&gt; ByteString) -&gt; String -&gt; IO Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="UTF8.html#toUTF8BS"><span class="hs-identifier hs-var">toUTF8BS</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#sendTo"><span class="hs-identifier hs-type">sendTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SockAddr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-65"></span><span id="sendTo"><span class="annot"><span class="annottext">sendTo :: Socket -&gt; String -&gt; SockAddr -&gt; IO Int
</span><a href="System.Log.Handler.Syslog.html#sendTo"><span class="hs-identifier hs-var hs-var">sendTo</span></a></span></span><span> </span><span id="local-6989586621679051044"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679051044"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679051043"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679051043"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Socket -&gt; ByteString -&gt; SockAddr -&gt; IO Int
</span><span class="hs-identifier hs-var">SBS.sendTo</span></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679051044"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="UTF8.html#toUTF8BS"><span class="hs-identifier hs-var">toUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679051043"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#code_of_pri"><span class="hs-identifier hs-type">code_of_pri</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-68"></span><span id="code_of_pri"><span class="annot"><span class="annottext">code_of_pri :: Priority -&gt; Int
</span><a href="System.Log.Handler.Syslog.html#code_of_pri"><span class="hs-identifier hs-var hs-var">code_of_pri</span></a></span></span><span> </span><span id="local-6989586621679051040"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679051040"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679051040"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-69"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#EMERGENCY"><span class="hs-identifier hs-var">EMERGENCY</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-70"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#ALERT"><span class="hs-identifier hs-var">ALERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-71"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#CRITICAL"><span class="hs-identifier hs-var">CRITICAL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-72"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#ERROR"><span class="hs-identifier hs-var">ERROR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-73"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#WARNING"><span class="hs-identifier hs-var">WARNING</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-74"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#NOTICE"><span class="hs-identifier hs-var">NOTICE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-75"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#INFO"><span class="hs-identifier hs-var">INFO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-76"></span><span>                       </span><span class="annot"><span class="annottext">Priority
</span><a href="System.Log.html#DEBUG"><span class="hs-identifier hs-var">DEBUG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">{- | Facilities are used by the system to determine where messages
are sent. -}</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="Facility"><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-var">Facility</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-82"></span><span>              </span><span id="KERN"><span class="annot"><a href="System.Log.Handler.Syslog.html#KERN"><span class="hs-identifier hs-var">KERN</span></a></span></span><span>                      </span><span class="hs-comment">-- ^ Kernel messages; you should likely never use this in your programs</span><span>
</span><span id="line-83"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="USER"><span class="annot"><a href="System.Log.Handler.Syslog.html#USER"><span class="hs-identifier hs-var">USER</span></a></span></span><span>                    </span><span class="hs-comment">-- ^ General userland messages.  Use this if nothing else is appropriate</span><span>
</span><span id="line-84"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="MAIL"><span class="annot"><a href="System.Log.Handler.Syslog.html#MAIL"><span class="hs-identifier hs-var">MAIL</span></a></span></span><span>                    </span><span class="hs-comment">-- ^ E-Mail system</span><span>
</span><span id="line-85"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="DAEMON"><span class="annot"><a href="System.Log.Handler.Syslog.html#DAEMON"><span class="hs-identifier hs-var">DAEMON</span></a></span></span><span>                  </span><span class="hs-comment">-- ^ Daemon (server process) messages</span><span>
</span><span id="line-86"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="AUTH"><span class="annot"><a href="System.Log.Handler.Syslog.html#AUTH"><span class="hs-identifier hs-var">AUTH</span></a></span></span><span>                    </span><span class="hs-comment">-- ^ Authentication or security messages</span><span>
</span><span id="line-87"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="SYSLOG"><span class="annot"><a href="System.Log.Handler.Syslog.html#SYSLOG"><span class="hs-identifier hs-var">SYSLOG</span></a></span></span><span>                  </span><span class="hs-comment">-- ^ Internal syslog messages; you should likely never use this in your programs</span><span>
</span><span id="line-88"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LPR"><span class="annot"><a href="System.Log.Handler.Syslog.html#LPR"><span class="hs-identifier hs-var">LPR</span></a></span></span><span>                     </span><span class="hs-comment">-- ^ Printer messages</span><span>
</span><span id="line-89"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="NEWS"><span class="annot"><a href="System.Log.Handler.Syslog.html#NEWS"><span class="hs-identifier hs-var">NEWS</span></a></span></span><span>                    </span><span class="hs-comment">-- ^ Usenet news</span><span>
</span><span id="line-90"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="UUCP"><span class="annot"><a href="System.Log.Handler.Syslog.html#UUCP"><span class="hs-identifier hs-var">UUCP</span></a></span></span><span>                    </span><span class="hs-comment">-- ^ UUCP messages</span><span>
</span><span id="line-91"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="CRON"><span class="annot"><a href="System.Log.Handler.Syslog.html#CRON"><span class="hs-identifier hs-var">CRON</span></a></span></span><span>                    </span><span class="hs-comment">-- ^ Cron messages</span><span>
</span><span id="line-92"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="AUTHPRIV"><span class="annot"><a href="System.Log.Handler.Syslog.html#AUTHPRIV"><span class="hs-identifier hs-var">AUTHPRIV</span></a></span></span><span>                </span><span class="hs-comment">-- ^ Private authentication messages</span><span>
</span><span id="line-93"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="FTP"><span class="annot"><a href="System.Log.Handler.Syslog.html#FTP"><span class="hs-identifier hs-var">FTP</span></a></span></span><span>                     </span><span class="hs-comment">-- ^ FTP messages</span><span>
</span><span id="line-94"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL0"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL0"><span class="hs-identifier hs-var">LOCAL0</span></a></span></span><span>                  </span><span class="hs-comment">-- ^ LOCAL0 through LOCAL7 are reserved for you to customize as you wish</span><span>
</span><span id="line-95"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL1"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL1"><span class="hs-identifier hs-var">LOCAL1</span></a></span></span><span>
</span><span id="line-96"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL2"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL2"><span class="hs-identifier hs-var">LOCAL2</span></a></span></span><span>
</span><span id="line-97"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL3"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL3"><span class="hs-identifier hs-var">LOCAL3</span></a></span></span><span>
</span><span id="line-98"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL4"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL4"><span class="hs-identifier hs-var">LOCAL4</span></a></span></span><span>
</span><span id="line-99"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL5"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL5"><span class="hs-identifier hs-var">LOCAL5</span></a></span></span><span>
</span><span id="line-100"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL6"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL6"><span class="hs-identifier hs-var">LOCAL6</span></a></span></span><span>
</span><span id="line-101"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="LOCAL7"><span class="annot"><a href="System.Log.Handler.Syslog.html#LOCAL7"><span class="hs-identifier hs-var">LOCAL7</span></a></span></span><span>
</span><span id="line-102"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051008"><span id="local-6989586621679051010"><span class="annot"><span class="annottext">Facility -&gt; Facility -&gt; Bool
(Facility -&gt; Facility -&gt; Bool)
-&gt; (Facility -&gt; Facility -&gt; Bool) -&gt; Eq Facility
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Facility -&gt; Facility -&gt; Bool
$c/= :: Facility -&gt; Facility -&gt; Bool
== :: Facility -&gt; Facility -&gt; Bool
$c== :: Facility -&gt; Facility -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051001"><span id="local-6989586621679051003"><span id="local-6989586621679051005"><span class="annot"><span class="annottext">Int -&gt; Facility -&gt; ShowS
[Facility] -&gt; ShowS
Facility -&gt; String
(Int -&gt; Facility -&gt; ShowS)
-&gt; (Facility -&gt; String) -&gt; ([Facility] -&gt; ShowS) -&gt; Show Facility
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Facility] -&gt; ShowS
$cshowList :: [Facility] -&gt; ShowS
show :: Facility -&gt; String
$cshow :: Facility -&gt; String
showsPrec :: Int -&gt; Facility -&gt; ShowS
$cshowsPrec :: Int -&gt; Facility -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050992"><span id="local-6989586621679050994"><span id="local-6989586621679050996"><span id="local-6989586621679050998"><span class="annot"><span class="annottext">ReadPrec [Facility]
ReadPrec Facility
Int -&gt; ReadS Facility
ReadS [Facility]
(Int -&gt; ReadS Facility)
-&gt; ReadS [Facility]
-&gt; ReadPrec Facility
-&gt; ReadPrec [Facility]
-&gt; Read Facility
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Facility]
$creadListPrec :: ReadPrec [Facility]
readPrec :: ReadPrec Facility
$creadPrec :: ReadPrec Facility
readList :: ReadS [Facility]
$creadList :: ReadS [Facility]
readsPrec :: Int -&gt; ReadS Facility
$creadsPrec :: Int -&gt; ReadS Facility
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#code_of_fac"><span class="hs-identifier hs-type">code_of_fac</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-type">Facility</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-105"></span><span id="code_of_fac"><span class="annot"><span class="annottext">code_of_fac :: Facility -&gt; Int
</span><a href="System.Log.Handler.Syslog.html#code_of_fac"><span class="hs-identifier hs-var hs-var">code_of_fac</span></a></span></span><span> </span><span id="local-6989586621679050989"><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050989"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050989"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-106"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#KERN"><span class="hs-identifier hs-var">KERN</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-107"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#USER"><span class="hs-identifier hs-var">USER</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-108"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#MAIL"><span class="hs-identifier hs-var">MAIL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-109"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#DAEMON"><span class="hs-identifier hs-var">DAEMON</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-110"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#AUTH"><span class="hs-identifier hs-var">AUTH</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-111"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#SYSLOG"><span class="hs-identifier hs-var">SYSLOG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-112"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LPR"><span class="hs-identifier hs-var">LPR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-113"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#NEWS"><span class="hs-identifier hs-var">NEWS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-114"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#UUCP"><span class="hs-identifier hs-var">UUCP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-115"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#CRON"><span class="hs-identifier hs-var">CRON</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-116"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#AUTHPRIV"><span class="hs-identifier hs-var">AUTHPRIV</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-117"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#FTP"><span class="hs-identifier hs-var">FTP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span>
</span><span id="line-118"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL0"><span class="hs-identifier hs-var">LOCAL0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-119"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL1"><span class="hs-identifier hs-var">LOCAL1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">17</span></span><span>
</span><span id="line-120"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL2"><span class="hs-identifier hs-var">LOCAL2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">18</span></span><span>
</span><span id="line-121"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL3"><span class="hs-identifier hs-var">LOCAL3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">19</span></span><span>
</span><span id="line-122"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL4"><span class="hs-identifier hs-var">LOCAL4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span>
</span><span id="line-123"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL5"><span class="hs-identifier hs-var">LOCAL5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">21</span></span><span>
</span><span id="line-124"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL6"><span class="hs-identifier hs-var">LOCAL6</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">22</span></span><span>
</span><span id="line-125"></span><span>                       </span><span class="annot"><span class="annottext">Facility
</span><a href="System.Log.Handler.Syslog.html#LOCAL7"><span class="hs-identifier hs-var">LOCAL7</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">23</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#makeCode"><span class="hs-identifier hs-type">makeCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-type">Facility</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-128"></span><span id="makeCode"><span class="annot"><span class="annottext">makeCode :: Facility -&gt; Priority -&gt; Int
</span><a href="System.Log.Handler.Syslog.html#makeCode"><span class="hs-identifier hs-var hs-var">makeCode</span></a></span></span><span> </span><span id="local-6989586621679050987"><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050987"><span class="hs-identifier hs-var">fac</span></a></span></span><span> </span><span id="local-6989586621679050986"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050986"><span class="hs-identifier hs-var">pri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679050985"><span class="annot"><span class="annottext">faccode :: Int
</span><a href="#local-6989586621679050985"><span class="hs-identifier hs-var hs-var">faccode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Facility -&gt; Int
</span><a href="System.Log.Handler.Syslog.html#code_of_fac"><span class="hs-identifier hs-var">code_of_fac</span></a></span><span> </span><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050987"><span class="hs-identifier hs-var">fac</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span id="local-6989586621679050984"><span class="annot"><span class="annottext">pricode :: Int
</span><a href="#local-6989586621679050984"><span class="hs-identifier hs-var hs-var">pricode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Priority -&gt; Int
</span><a href="System.Log.Handler.Syslog.html#code_of_pri"><span class="hs-identifier hs-var">code_of_pri</span></a></span><span> </span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050986"><span class="hs-identifier hs-var">pri</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050985"><span class="hs-identifier hs-var">faccode</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050984"><span class="hs-identifier hs-var">pricode</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">{- | Options for 'openlog'. -}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">data</span><span> </span><span id="Option"><span class="annot"><a href="System.Log.Handler.Syslog.html#Option"><span class="hs-identifier hs-var">Option</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PID"><span class="annot"><a href="System.Log.Handler.Syslog.html#PID"><span class="hs-identifier hs-var">PID</span></a></span></span><span>                       </span><span class="hs-comment">-- ^ Automatically log process ID (PID) with each message</span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="PERROR"><span class="annot"><a href="System.Log.Handler.Syslog.html#PERROR"><span class="hs-identifier hs-var">PERROR</span></a></span></span><span>                    </span><span class="hs-comment">-- ^ Send a copy of each message to stderr</span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050976"><span id="local-6989586621679050978"><span class="annot"><span class="annottext">Option -&gt; Option -&gt; Bool
(Option -&gt; Option -&gt; Bool)
-&gt; (Option -&gt; Option -&gt; Bool) -&gt; Eq Option
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Option -&gt; Option -&gt; Bool
$c/= :: Option -&gt; Option -&gt; Bool
== :: Option -&gt; Option -&gt; Bool
$c== :: Option -&gt; Option -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679050970"><span id="local-6989586621679050972"><span id="local-6989586621679050974"><span class="annot"><span class="annottext">Int -&gt; Option -&gt; ShowS
[Option] -&gt; ShowS
Option -&gt; String
(Int -&gt; Option -&gt; ShowS)
-&gt; (Option -&gt; String) -&gt; ([Option] -&gt; ShowS) -&gt; Show Option
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Option] -&gt; ShowS
$cshowList :: [Option] -&gt; ShowS
show :: Option -&gt; String
$cshow :: Option -&gt; String
showsPrec :: Int -&gt; Option -&gt; ShowS
$cshowsPrec :: Int -&gt; Option -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679050962"><span id="local-6989586621679050964"><span id="local-6989586621679050966"><span id="local-6989586621679050968"><span class="annot"><span class="annottext">ReadPrec [Option]
ReadPrec Option
Int -&gt; ReadS Option
ReadS [Option]
(Int -&gt; ReadS Option)
-&gt; ReadS [Option]
-&gt; ReadPrec Option
-&gt; ReadPrec [Option]
-&gt; Read Option
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Option]
$creadListPrec :: ReadPrec [Option]
readPrec :: ReadPrec Option
$creadPrec :: ReadPrec Option
readList :: ReadS [Option]
$creadList :: ReadS [Option]
readsPrec :: Int -&gt; ReadS Option
$creadsPrec :: Int -&gt; ReadS Option
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">data</span><span> </span><span id="SyslogHandler"><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-var">SyslogHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SyslogHandler"><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-var">SyslogHandler</span></a></span></span><span> </span><span class="hs-special">{</span><span id="options"><span class="annot"><span class="annottext">SyslogHandler -&gt; [Option]
</span><a href="System.Log.Handler.Syslog.html#options"><span class="hs-identifier hs-var hs-var">options</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.Log.Handler.Syslog.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>                                    </span><span id="facility"><span class="annot"><span class="annottext">SyslogHandler -&gt; Facility
</span><a href="System.Log.Handler.Syslog.html#facility"><span class="hs-identifier hs-var hs-var">facility</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-type">Facility</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>                                    </span><span id="identity"><span class="annot"><span class="annottext">SyslogHandler -&gt; String
</span><a href="System.Log.Handler.Syslog.html#identity"><span class="hs-identifier hs-var hs-var">identity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>                                    </span><span id="logsocket"><span class="annot"><span class="annottext">SyslogHandler -&gt; Socket
</span><a href="System.Log.Handler.Syslog.html#logsocket"><span class="hs-identifier hs-var hs-var">logsocket</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>                                    </span><span id="address"><span class="annot"><span class="annottext">SyslogHandler -&gt; SockAddr
</span><a href="System.Log.Handler.Syslog.html#address"><span class="hs-identifier hs-var hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SockAddr</span></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>                                    </span><span id="sock_type"><span class="annot"><span class="annottext">SyslogHandler -&gt; SocketType
</span><a href="System.Log.Handler.Syslog.html#sock_type"><span class="hs-identifier hs-var hs-var">sock_type</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SocketType</span></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>                                    </span><span id="priority"><span class="annot"><span class="annottext">SyslogHandler -&gt; Priority
</span><a href="System.Log.Handler.Syslog.html#priority"><span class="hs-identifier hs-var hs-var">priority</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>                                    </span><span id="formatter"><span class="annot"><span class="annottext">SyslogHandler -&gt; LogFormatter SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#formatter"><span class="hs-identifier hs-var hs-var">formatter</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Log.Formatter.html#LogFormatter"><span class="hs-identifier hs-type">LogFormatter</span></a></span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span><span>
</span><span id="line-147"></span><span>                                   </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">{- | Initialize the Syslog system using the local system's default interface,
\/dev\/log.  Will return a new 'System.Log.Handler.LogHandler'.

On Windows, instead of using \/dev\/log, this will attempt to send
UDP messages to something listening on the syslog port (514) on localhost.

Use 'openlog_remote' if you need more control.
-}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog"><span class="hs-identifier hs-type">openlog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                       </span><span class="hs-comment">-- ^ The name of this program -- will be prepended to every log message</span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.Log.Handler.Syslog.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span class="hs-special">]</span><span>                     </span><span class="hs-comment">-- ^ A list of 'Option's.  The list [] is perfectly valid.  ['PID'] is probably most common here.</span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-type">Facility</span></a></span><span>                     </span><span class="hs-comment">-- ^ The 'Facility' value to pass to the syslog system for every message logged</span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a></span><span>                     </span><span class="hs-comment">-- ^ Messages logged below this priority will be ignored.  To include every message, set this to 'DEBUG'.</span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span><span>             </span><span class="hs-comment">-- ^ Returns the new handler</span><span class="hs-cpp">

#ifdef mingw32_HOST_OS
</span><span class="hs-identifier">openlog</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">openlog_remote</span><span> </span><span class="hs-identifier">S.AF_INET</span><span> </span><span class="hs-string">&quot;localhost&quot;</span><span> </span><span class="hs-number">514</span><span class="hs-cpp">
#elif darwin_HOST_OS
</span><span class="hs-identifier">openlog</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">openlog_local</span><span> </span><span class="hs-string">&quot;/var/run/syslog&quot;</span><span class="hs-cpp">
#else
</span><span id="openlog"><span class="annot"><span class="annottext">openlog :: String -&gt; [Option] -&gt; Facility -&gt; Priority -&gt; IO SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#openlog"><span class="hs-identifier hs-var hs-var">openlog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String -&gt; [Option] -&gt; Facility -&gt; Priority -&gt; IO SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#openlog_local"><span class="hs-identifier hs-var">openlog_local</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/dev/log&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-172"></span><span class="hs-comment">{- | Initialize the Syslog system using an arbitrary Unix socket (FIFO).

Not supported under Windows.
-}</span><span class="hs-cpp">

#ifndef mingw32_HOST_OS
</span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog_local"><span class="hs-identifier hs-type">openlog_local</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                 </span><span class="hs-comment">-- ^ Path to FIFO</span><span>
</span><span id="line-179"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                 </span><span class="hs-comment">-- ^ Program name</span><span>
</span><span id="line-180"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.Log.Handler.Syslog.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span class="hs-special">]</span><span>               </span><span class="hs-comment">-- ^ 'Option's</span><span>
</span><span id="line-181"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-type">Facility</span></a></span><span>               </span><span class="hs-comment">-- ^ Facility value</span><span>
</span><span id="line-182"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a></span><span>               </span><span class="hs-comment">-- ^ Priority limit</span><span>
</span><span id="line-183"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span><span>
</span><span id="line-184"></span><span id="openlog_local"><span class="annot"><span class="annottext">openlog_local :: String
-&gt; String -&gt; [Option] -&gt; Facility -&gt; Priority -&gt; IO SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#openlog_local"><span class="hs-identifier hs-var hs-var">openlog_local</span></a></span></span><span> </span><span id="local-6989586621679050952"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050952"><span class="hs-identifier hs-var">fifopath</span></a></span></span><span> </span><span id="local-6989586621679050951"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050951"><span class="hs-identifier hs-var">ident</span></a></span></span><span> </span><span id="local-6989586621679050950"><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621679050950"><span class="hs-identifier hs-var">options'</span></a></span></span><span> </span><span id="local-6989586621679050949"><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050949"><span class="hs-identifier hs-var">fac</span></a></span></span><span> </span><span id="local-6989586621679050948"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050948"><span class="hs-identifier hs-var">pri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050947"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050947"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050946"><span class="annot"><span class="annottext">SocketType
</span><a href="#local-6989586621679050946"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- &quot;/dev/log&quot; is usually Datagram,</span><span>
</span><span id="line-186"></span><span>                    </span><span class="hs-comment">-- but most of syslog loggers allow it to be</span><span>
</span><span id="line-187"></span><span>                    </span><span class="hs-comment">-- of Stream type. glibc's&quot; openlog()&quot;</span><span>
</span><span id="line-188"></span><span>                    </span><span class="hs-comment">-- does roughly the similar thing:</span><span>
</span><span id="line-189"></span><span>                    </span><span class="hs-comment">--     http://www.gnu.org/software/libc/manual/html_node/openlog.html</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>                    </span><span id="local-6989586621679050945"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050945"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Family -&gt; SocketType -&gt; ProtocolNumber -&gt; IO Socket
</span><span class="hs-identifier hs-var">S.socket</span></span><span> </span><span class="annot"><span class="annottext">Family
</span><span class="hs-identifier hs-var">S.AF_UNIX</span></span><span> </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Stream</span></span><span> </span><span class="annot"><span class="annottext">ProtocolNumber
</span><span class="hs-number">0</span></span><span>
</span><span id="line-192"></span><span>                    </span><span class="annot"><span class="annottext">Socket -&gt; IO (Socket, SocketType)
</span><a href="#local-6989586621679050941"><span class="hs-identifier hs-var">tryStream</span></a></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050945"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Socket, SocketType)
-&gt; (IOException -&gt; IO (Socket, SocketType))
-&gt; IO (Socket, SocketType)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Socket, SocketType) -&gt; IOException -&gt; IO (Socket, SocketType)
forall a. IO a -&gt; IOException -&gt; IO a
</span><a href="#local-6989586621679050939"><span class="hs-identifier hs-var">onIOException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Socket -&gt; IO (Socket, SocketType)
</span><a href="#local-6989586621679050938"><span class="hs-identifier hs-var">fallbackToDgram</span></a></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050945"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>       </span><span class="annot"><span class="annottext">Socket
-&gt; SockAddr
-&gt; SocketType
-&gt; String
-&gt; [Option]
-&gt; Facility
-&gt; Priority
-&gt; IO SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#openlog_generic"><span class="hs-identifier hs-var">openlog_generic</span></a></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050947"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SockAddr
</span><span class="hs-identifier hs-var">S.SockAddrUnix</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050952"><span class="hs-identifier hs-var">fifopath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SocketType
</span><a href="#local-6989586621679050946"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050951"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621679050950"><span class="hs-identifier hs-var">options'</span></a></span><span> </span><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050949"><span class="hs-identifier hs-var">fac</span></a></span><span> </span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050948"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679051086"><span class="annot"><a href="#local-6989586621679050939"><span class="hs-identifier hs-type">onIOException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679051086"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.IOException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679051086"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-196"></span><span>        </span><span id="local-6989586621679050939"><span class="annot"><span class="annottext">onIOException :: IO a -&gt; IOException -&gt; IO a
</span><a href="#local-6989586621679050939"><span class="hs-identifier hs-var hs-var">onIOException</span></a></span></span><span> </span><span id="local-6989586621679050936"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679050936"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679050936"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><a href="#local-6989586621679050941"><span class="hs-identifier hs-type">tryStream</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SocketType</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>        </span><span id="local-6989586621679050941"><span class="annot"><span class="annottext">tryStream :: Socket -&gt; IO (Socket, SocketType)
</span><a href="#local-6989586621679050941"><span class="hs-identifier hs-var hs-var">tryStream</span></a></span></span><span> </span><span id="local-6989586621679050935"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050935"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Socket -&gt; SockAddr -&gt; IO ()
</span><span class="hs-identifier hs-var">S.connect</span></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050935"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SockAddr
</span><span class="hs-identifier hs-var">S.SockAddrUnix</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050952"><span class="hs-identifier hs-var">fifopath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>               </span><span class="annot"><span class="annottext">(Socket, SocketType) -&gt; IO (Socket, SocketType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050935"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Stream</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="#local-6989586621679050938"><span class="hs-identifier hs-type">fallbackToDgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SocketType</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>        </span><span id="local-6989586621679050938"><span class="annot"><span class="annottext">fallbackToDgram :: Socket -&gt; IO (Socket, SocketType)
</span><a href="#local-6989586621679050938"><span class="hs-identifier hs-var hs-var">fallbackToDgram</span></a></span></span><span> </span><span id="local-6989586621679050933"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050933"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Socket -&gt; IO ()
</span><span class="hs-identifier hs-var">S.close</span></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050933"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-comment">-- close Stream variant</span><span>
</span><span id="line-206"></span><span>               </span><span id="local-6989586621679050931"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050931"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Family -&gt; SocketType -&gt; ProtocolNumber -&gt; IO Socket
</span><span class="hs-identifier hs-var">S.socket</span></span><span> </span><span class="annot"><span class="annottext">Family
</span><span class="hs-identifier hs-var">S.AF_UNIX</span></span><span> </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Datagram</span></span><span> </span><span class="annot"><span class="annottext">ProtocolNumber
</span><span class="hs-number">0</span></span><span>
</span><span id="line-207"></span><span>               </span><span class="annot"><span class="annottext">(Socket, SocketType) -&gt; IO (Socket, SocketType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050931"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Datagram</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-210"></span><span class="hs-comment">{- | Log to a remote server via UDP. -}</span><span>
</span><span id="line-211"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog_remote"><span class="hs-identifier hs-type">openlog_remote</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Family</span></span><span>              </span><span class="hs-comment">-- ^ Usually AF_INET or AF_INET6; see Network.Socket</span><span>
</span><span id="line-212"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.HostName</span></span><span>            </span><span class="hs-comment">-- ^ Remote hostname.  Some use @localhost@</span><span>
</span><span id="line-213"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.PortNumber</span></span><span>          </span><span class="hs-comment">-- ^ 514 is the default for syslog</span><span>
</span><span id="line-214"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                </span><span class="hs-comment">-- ^ Program name</span><span>
</span><span id="line-215"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.Log.Handler.Syslog.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span class="hs-special">]</span><span>              </span><span class="hs-comment">-- ^ 'Option's</span><span>
</span><span id="line-216"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-type">Facility</span></a></span><span>              </span><span class="hs-comment">-- ^ Facility value</span><span>
</span><span id="line-217"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a></span><span>              </span><span class="hs-comment">-- ^ Priority limit</span><span>
</span><span id="line-218"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span><span>
</span><span id="line-219"></span><span id="openlog_remote"><span class="annot"><span class="annottext">openlog_remote :: Family
-&gt; String
-&gt; PortNumber
-&gt; String
-&gt; [Option]
-&gt; Facility
-&gt; Priority
-&gt; IO SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#openlog_remote"><span class="hs-identifier hs-var hs-var">openlog_remote</span></a></span></span><span> </span><span id="local-6989586621679050928"><span class="annot"><span class="annottext">Family
</span><a href="#local-6989586621679050928"><span class="hs-identifier hs-var">fam</span></a></span></span><span> </span><span id="local-6989586621679050927"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050927"><span class="hs-identifier hs-var">hostname</span></a></span></span><span> </span><span id="local-6989586621679050926"><span class="annot"><span class="annottext">PortNumber
</span><a href="#local-6989586621679050926"><span class="hs-identifier hs-var">port</span></a></span></span><span> </span><span id="local-6989586621679050925"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050925"><span class="hs-identifier hs-var">ident</span></a></span></span><span> </span><span id="local-6989586621679050924"><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621679050924"><span class="hs-identifier hs-var">options'</span></a></span></span><span> </span><span id="local-6989586621679050923"><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050923"><span class="hs-identifier hs-var">fac</span></a></span></span><span> </span><span id="local-6989586621679050922"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050922"><span class="hs-identifier hs-var">pri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679050921"><span class="annot"><span class="annottext">HostEntry
</span><a href="#local-6989586621679050921"><span class="hs-identifier hs-var">he</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO HostEntry
</span><span class="hs-identifier hs-var">S.getHostByName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050927"><span class="hs-identifier hs-var">hostname</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679050919"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050919"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Family -&gt; SocketType -&gt; ProtocolNumber -&gt; IO Socket
</span><span class="hs-identifier hs-var">S.socket</span></span><span> </span><span class="annot"><span class="annottext">Family
</span><a href="#local-6989586621679050928"><span class="hs-identifier hs-var">fam</span></a></span><span> </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Datagram</span></span><span> </span><span class="annot"><span class="annottext">ProtocolNumber
</span><span class="hs-number">0</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679050918"><span class="annot"><span class="annottext">addr :: SockAddr
</span><a href="#local-6989586621679050918"><span class="hs-identifier hs-var hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PortNumber -&gt; HostAddress -&gt; SockAddr
</span><span class="hs-identifier hs-var">S.SockAddrInet</span></span><span> </span><span class="annot"><span class="annottext">PortNumber
</span><a href="#local-6989586621679050926"><span class="hs-identifier hs-var">port</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[HostAddress] -&gt; HostAddress
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HostEntry -&gt; [HostAddress]
</span><span class="hs-identifier hs-var hs-var">S.hostAddresses</span></span><span> </span><span class="annot"><span class="annottext">HostEntry
</span><a href="#local-6989586621679050921"><span class="hs-identifier hs-var">he</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">Socket
-&gt; SockAddr
-&gt; SocketType
-&gt; String
-&gt; [Option]
-&gt; Facility
-&gt; Priority
-&gt; IO SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#openlog_generic"><span class="hs-identifier hs-var">openlog_generic</span></a></span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050919"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">SockAddr
</span><a href="#local-6989586621679050918"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Datagram</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050925"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621679050924"><span class="hs-identifier hs-var">options'</span></a></span><span> </span><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050923"><span class="hs-identifier hs-var">fac</span></a></span><span> </span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050922"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">{- | The most powerful initialization mechanism.  Takes an open datagram
socket. -}</span><span>
</span><span id="line-228"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#openlog_generic"><span class="hs-identifier hs-type">openlog_generic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Socket</span></span><span>             </span><span class="hs-comment">-- ^ A datagram socket</span><span>
</span><span id="line-229"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SockAddr</span></span><span>           </span><span class="hs-comment">-- ^ Address for transmissions</span><span>
</span><span id="line-230"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.SocketType</span></span><span>         </span><span class="hs-comment">-- ^ socket connection mode (stream / datagram)</span><span>
</span><span id="line-231"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>               </span><span class="hs-comment">-- ^ Program name</span><span>
</span><span id="line-232"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.Log.Handler.Syslog.html#Option"><span class="hs-identifier hs-type">Option</span></a></span><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ 'Option's</span><span>
</span><span id="line-233"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#Facility"><span class="hs-identifier hs-type">Facility</span></a></span><span>             </span><span class="hs-comment">-- ^ Facility value</span><span>
</span><span id="line-234"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Log.html#Priority"><span class="hs-identifier hs-type">Priority</span></a></span><span>             </span><span class="hs-comment">-- ^ Priority limit</span><span>
</span><span id="line-235"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span><span>
</span><span id="line-236"></span><span id="openlog_generic"><span class="annot"><span class="annottext">openlog_generic :: Socket
-&gt; SockAddr
-&gt; SocketType
-&gt; String
-&gt; [Option]
-&gt; Facility
-&gt; Priority
-&gt; IO SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#openlog_generic"><span class="hs-identifier hs-var hs-var">openlog_generic</span></a></span></span><span> </span><span id="local-6989586621679050914"><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050914"><span class="hs-identifier hs-var">sock</span></a></span></span><span> </span><span id="local-6989586621679050913"><span class="annot"><span class="annottext">SockAddr
</span><a href="#local-6989586621679050913"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679050912"><span class="annot"><span class="annottext">SocketType
</span><a href="#local-6989586621679050912"><span class="hs-identifier hs-var">sock_t</span></a></span></span><span> </span><span id="local-6989586621679050911"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050911"><span class="hs-identifier hs-var">ident</span></a></span></span><span> </span><span id="local-6989586621679050910"><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621679050910"><span class="hs-identifier hs-var">opt</span></a></span></span><span> </span><span id="local-6989586621679050909"><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050909"><span class="hs-identifier hs-var">fac</span></a></span></span><span> </span><span id="local-6989586621679050908"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050908"><span class="hs-identifier hs-var">pri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">SyslogHandler -&gt; IO SyslogHandler
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler :: [Option]
-&gt; Facility
-&gt; String
-&gt; Socket
-&gt; SockAddr
-&gt; SocketType
-&gt; Priority
-&gt; LogFormatter SyslogHandler
-&gt; SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">options :: [Option]
</span><a href="System.Log.Handler.Syslog.html#options"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621679050910"><span class="hs-identifier hs-var">opt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-238"></span><span>                            </span><span class="annot"><span class="annottext">facility :: Facility
</span><a href="System.Log.Handler.Syslog.html#facility"><span class="hs-identifier hs-var">facility</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Facility
</span><a href="#local-6989586621679050909"><span class="hs-identifier hs-var">fac</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>                            </span><span class="annot"><span class="annottext">identity :: String
</span><a href="System.Log.Handler.Syslog.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050911"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>                            </span><span class="annot"><span class="annottext">logsocket :: Socket
</span><a href="System.Log.Handler.Syslog.html#logsocket"><span class="hs-identifier hs-var">logsocket</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Socket
</span><a href="#local-6989586621679050914"><span class="hs-identifier hs-var">sock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-241"></span><span>                            </span><span class="annot"><span class="annottext">address :: SockAddr
</span><a href="System.Log.Handler.Syslog.html#address"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SockAddr
</span><a href="#local-6989586621679050913"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-242"></span><span>                            </span><span class="annot"><span class="annottext">sock_type :: SocketType
</span><a href="System.Log.Handler.Syslog.html#sock_type"><span class="hs-identifier hs-var">sock_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SocketType
</span><a href="#local-6989586621679050912"><span class="hs-identifier hs-var">sock_t</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-243"></span><span>                            </span><span class="annot"><span class="annottext">priority :: Priority
</span><a href="System.Log.Handler.Syslog.html#priority"><span class="hs-identifier hs-var">priority</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050908"><span class="hs-identifier hs-var">pri</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-244"></span><span>                            </span><span class="annot"><span class="annottext">formatter :: LogFormatter SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#formatter"><span class="hs-identifier hs-var">formatter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogFormatter SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#syslogFormatter"><span class="hs-identifier hs-var">syslogFormatter</span></a></span><span>
</span><span id="line-245"></span><span>                          </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="System.Log.Handler.Syslog.html#syslogFormatter"><span class="hs-identifier hs-type">syslogFormatter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Log.Formatter.html#LogFormatter"><span class="hs-identifier hs-type">LogFormatter</span></a></span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span><span>
</span><span id="line-248"></span><span id="syslogFormatter"><span class="annot"><span class="annottext">syslogFormatter :: LogFormatter SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#syslogFormatter"><span class="hs-identifier hs-var hs-var">syslogFormatter</span></a></span></span><span> </span><span id="local-6989586621679050906"><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050906"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050905"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050905"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050904"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050904"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050903"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050903"><span class="hs-identifier hs-var">logname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679050902"><span class="annot"><span class="annottext">format :: String
</span><a href="#local-6989586621679050902"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[$loggername/$prio] $msg&quot;</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(String, IO String)] -&gt; String -&gt; LogFormatter SyslogHandler
forall a. [(String, IO String)] -&gt; String -&gt; LogFormatter a
</span><a href="System.Log.Formatter.html#varFormatter"><span class="hs-identifier hs-var">varFormatter</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050902"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050906"><span class="hs-identifier hs-var">sh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050905"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050904"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050903"><span class="hs-identifier hs-var">logname</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050895"><span class="annot"><a href="System.Log.Handler.html#LogHandler"><span class="hs-identifier hs-type">LogHandler</span></a></span><span> </span><span class="annot"><a href="System.Log.Handler.Syslog.html#SyslogHandler"><span class="hs-identifier hs-type">SyslogHandler</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679050891"><span class="annot"><span class="annottext">setLevel :: SyslogHandler -&gt; Priority -&gt; SyslogHandler
</span><a href="System.Log.Handler.html#setLevel"><span class="hs-identifier hs-var hs-var hs-var hs-var">setLevel</span></a></span></span><span> </span><span id="local-6989586621679050889"><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050889"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span id="local-6989586621679050888"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050888"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050889"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">priority :: Priority
</span><a href="System.Log.Handler.Syslog.html#priority"><span class="hs-identifier hs-var">priority</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050888"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679050887"><span class="annot"><span class="annottext">getLevel :: SyslogHandler -&gt; Priority
</span><a href="System.Log.Handler.html#getLevel"><span class="hs-identifier hs-var hs-var hs-var hs-var">getLevel</span></a></span></span><span> </span><span id="local-6989586621679050885"><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050885"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyslogHandler -&gt; Priority
</span><a href="System.Log.Handler.Syslog.html#priority"><span class="hs-identifier hs-var hs-var">priority</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050885"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679050884"><span class="annot"><span class="annottext">setFormatter :: SyslogHandler -&gt; LogFormatter SyslogHandler -&gt; SyslogHandler
</span><a href="System.Log.Handler.html#setFormatter"><span class="hs-identifier hs-var hs-var hs-var hs-var">setFormatter</span></a></span></span><span> </span><span id="local-6989586621679050882"><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050882"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span id="local-6989586621679050881"><span class="annot"><span class="annottext">LogFormatter SyslogHandler
</span><a href="#local-6989586621679050881"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050882"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">formatter :: LogFormatter SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#formatter"><span class="hs-identifier hs-var">formatter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogFormatter SyslogHandler
</span><a href="#local-6989586621679050881"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679050880"><span class="annot"><span class="annottext">getFormatter :: SyslogHandler -&gt; LogFormatter SyslogHandler
</span><a href="System.Log.Handler.html#getFormatter"><span class="hs-identifier hs-var hs-var hs-var hs-var">getFormatter</span></a></span></span><span> </span><span id="local-6989586621679050878"><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050878"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyslogHandler -&gt; LogFormatter SyslogHandler
</span><a href="System.Log.Handler.Syslog.html#formatter"><span class="hs-identifier hs-var hs-var">formatter</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050878"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679050877"><span class="annot"><span class="annottext">emit :: SyslogHandler -&gt; (Priority, String) -&gt; String -&gt; IO ()
</span><a href="System.Log.Handler.html#emit"><span class="hs-identifier hs-var hs-var hs-var hs-var">emit</span></a></span></span><span> </span><span id="local-6989586621679050875"><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050874"><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050874"><span class="hs-identifier hs-var">prio</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050873"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050873"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Option -&gt; [Option] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">Option
</span><a href="System.Log.Handler.Syslog.html#PERROR"><span class="hs-identifier hs-var">PERROR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler -&gt; [Option]
</span><a href="System.Log.Handler.Syslog.html#options"><span class="hs-identifier hs-var hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050873"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>      </span><span id="local-6989586621679050869"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050869"><span class="hs-identifier hs-var">pidPart</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="#local-6989586621679050868"><span class="hs-identifier hs-var">getPidPart</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><span class="annottext">IO String -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO String -&gt; IO ()) -&gt; IO String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="#local-6989586621679050867"><span class="hs-identifier hs-var">sendstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="#local-6989586621679050866"><span class="hs-identifier hs-var">toSyslogFormat</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050873"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050869"><span class="hs-identifier hs-var">pidPart</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><a href="#local-6989586621679050867"><span class="hs-identifier hs-type">sendstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621679050867"><span class="annot"><span class="annottext">sendstr :: String -&gt; IO String
</span><a href="#local-6989586621679050867"><span class="hs-identifier hs-var hs-var">sendstr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><a href="#local-6989586621679050867"><span class="hs-identifier hs-var">sendstr</span></a></span><span> </span><span id="local-6989586621679050865"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050865"><span class="hs-identifier hs-var">omsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>          </span><span id="local-6989586621679050864"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050864"><span class="hs-identifier hs-var">sent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SyslogHandler -&gt; SocketType
</span><a href="System.Log.Handler.Syslog.html#sock_type"><span class="hs-identifier hs-var hs-var">sock_type</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>                    </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Datagram</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Socket -&gt; String -&gt; SockAddr -&gt; IO Int
</span><a href="System.Log.Handler.Syslog.html#sendTo"><span class="hs-identifier hs-var">sendTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler -&gt; Socket
</span><a href="System.Log.Handler.Syslog.html#logsocket"><span class="hs-identifier hs-var hs-var">logsocket</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050865"><span class="hs-identifier hs-var">omsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler -&gt; SockAddr
</span><a href="System.Log.Handler.Syslog.html#address"><span class="hs-identifier hs-var hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>                    </span><span class="annot"><span class="annottext">SocketType
</span><span class="hs-identifier hs-var">S.Stream</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Socket -&gt; String -&gt; IO Int
</span><a href="System.Log.Handler.Syslog.html#send"><span class="hs-identifier hs-var">send</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler -&gt; Socket
</span><a href="System.Log.Handler.Syslog.html#logsocket"><span class="hs-identifier hs-var hs-var">logsocket</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050865"><span class="hs-identifier hs-var">omsg</span></a></span><span>
</span><span id="line-269"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="#local-6989586621679050867"><span class="hs-identifier hs-var">sendstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall i a. Integral i =&gt; i -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">genericDrop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050864"><span class="hs-identifier hs-var">sent</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050865"><span class="hs-identifier hs-var">omsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679050866"><span class="annot"><span class="annottext">toSyslogFormat :: String -&gt; ShowS
</span><a href="#local-6989586621679050866"><span class="hs-identifier hs-var hs-var">toSyslogFormat</span></a></span></span><span> </span><span id="local-6989586621679050863"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050863"><span class="hs-identifier hs-var">msg'</span></a></span></span><span> </span><span id="local-6989586621679050862"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050862"><span class="hs-identifier hs-var">pidPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050861"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050860"><span class="hs-identifier hs-var">identity'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050862"><span class="hs-identifier hs-var">pidPart</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050863"><span class="hs-identifier hs-var">msg'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\0&quot;</span></span><span>
</span><span id="line-272"></span><span>        </span><span id="local-6989586621679050861"><span class="annot"><span class="annottext">code :: String
</span><a href="#local-6989586621679050861"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Facility -&gt; Priority -&gt; Int
</span><a href="System.Log.Handler.Syslog.html#makeCode"><span class="hs-identifier hs-var">makeCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler -&gt; Facility
</span><a href="System.Log.Handler.Syslog.html#facility"><span class="hs-identifier hs-var hs-var">facility</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Priority
</span><a href="#local-6989586621679050874"><span class="hs-identifier hs-var">prio</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span id="local-6989586621679050860"><span class="annot"><span class="annottext">identity' :: String
</span><a href="#local-6989586621679050860"><span class="hs-identifier hs-var hs-var">identity'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SyslogHandler -&gt; String
</span><a href="System.Log.Handler.Syslog.html#identity"><span class="hs-identifier hs-var hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span id="local-6989586621679050868"><span class="annot"><span class="annottext">getPidPart :: IO String
</span><a href="#local-6989586621679050868"><span class="hs-identifier hs-var hs-var">getPidPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Option -&gt; [Option] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">Option
</span><a href="System.Log.Handler.Syslog.html#PID"><span class="hs-identifier hs-var">PID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler -&gt; [Option]
</span><a href="System.Log.Handler.Syslog.html#options"><span class="hs-identifier hs-var hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050875"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="#local-6989586621679050858"><span class="hs-identifier hs-var">getPid</span></a></span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO String) -&gt; IO String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679050857"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050857"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050857"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-277"></span><span>        </span><span class="annot"><a href="#local-6989586621679050858"><span class="hs-identifier hs-type">getPid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-278"></span><span>        </span><span id="local-6989586621679050858"><span class="annot"><span class="annottext">getPid :: IO String
</span><a href="#local-6989586621679050858"><span class="hs-identifier hs-var hs-var">getPid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifndef mingw32_HOST_OS
</span><span>          </span><span class="annot"><span class="annottext">IO ProcessID
</span><span class="hs-identifier hs-var">getProcessID</span></span><span> </span><span class="annot"><span class="annottext">IO ProcessID -&gt; (ProcessID -&gt; IO String) -&gt; IO String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String)
-&gt; (ProcessID -&gt; String) -&gt; ProcessID -&gt; IO String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ProcessID -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-cpp">
#else
</span><span>          </span><span class="hs-identifier">return</span><span> </span><span class="hs-string">&quot;windows&quot;</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621679050856"><span class="annot"><span class="annottext">close :: SyslogHandler -&gt; IO ()
</span><a href="System.Log.Handler.html#close"><span class="hs-identifier hs-var hs-var hs-var hs-var">close</span></a></span></span><span> </span><span id="local-6989586621679050854"><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050854"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Socket -&gt; IO ()
</span><span class="hs-identifier hs-var">S.close</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyslogHandler -&gt; Socket
</span><a href="System.Log.Handler.Syslog.html#logsocket"><span class="hs-identifier hs-var hs-var">logsocket</span></a></span><span> </span><span class="annot"><span class="annottext">SyslogHandler
</span><a href="#local-6989586621679050854"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span></pre></body></html>