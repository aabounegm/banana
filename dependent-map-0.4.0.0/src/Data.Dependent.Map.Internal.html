<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Dependent.Map.Internal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Dependent.Sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DSum</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:=&gt;)</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.GADT.Compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GCompare</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">GOrdering</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gcompare</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Some</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Some</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkSome</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withSome</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- |Dependent maps: 'k' is a GADT-like thing with a facility for</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- rediscovering its type parameter, elements of which function as identifiers</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- tagged with the type of the thing they identify.  Real GADTs are one</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- useful instantiation of @k@, as are 'Tag's from &quot;Data.Unique.Tag&quot; in the</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- 'prim-uniq' package.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Semantically, @'DMap' k f@ is equivalent to a set of @'DSum' k f@ where no two</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- elements have the same tag.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- More informally, 'DMap' is to dependent products as 'M.Map' is to @(-&gt;)@.</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Thus it could also be thought of as a partial (in the sense of \&quot;partial</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- function\&quot;) dependent product.</span><span>
</span><span id="line-27"></span><span class="hs-keyword">data</span><span> </span><span id="DMap"><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-var">DMap</span></a></span></span><span> </span><span id="local-6989586621679050640"><span class="annot"><a href="#local-6989586621679050640"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679050639"><span class="annot"><a href="#local-6989586621679050639"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>    </span><span id="local-6989586621679050854"><span id="local-6989586621679050855"><span id="Tip"><span class="annot"><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050855"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050854"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-29"></span><span>    </span><span id="local-6989586621679050637"><span id="local-6989586621679050846"><span id="local-6989586621679050848"><span id="Bin"><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-comment">{- sz    -}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-30"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">{- key   -}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050637"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">{- value -}</span><span> </span><span class="annot"><a href="#local-6989586621679050846"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050637"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-32"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">{- left  -}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050846"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">{- right -}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050846"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050848"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050846"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">{--------------------------------------------------------------------
  Construction
--------------------------------------------------------------------}</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | /O(1)/. The empty map.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- &gt; empty      == fromList []</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- &gt; size empty == 0</span><span>
</span><span id="line-45"></span><span id="local-6989586621679050634"><span id="local-6989586621679050635"><span class="annot"><a href="Data.Dependent.Map.Internal.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050635"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050634"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-46"></span><span id="empty"><span class="annot"><span class="annottext">empty :: DMap k f
</span><a href="Data.Dependent.Map.Internal.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | /O(1)/. A map with a single element.</span><span>
</span><span id="line-49"></span><span class="hs-comment">--</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- &gt; singleton 1 'a'        == fromList [(1, 'a')]</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- &gt; size (singleton 1 'a') == 1</span><span>
</span><span id="line-52"></span><span id="local-6989586621679050779"><span id="local-6989586621679050780"><span id="local-6989586621679050781"><span class="annot"><a href="Data.Dependent.Map.Internal.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050781"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050780"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050780"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050781"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050779"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-53"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: k v -&gt; f v -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621679050631"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050631"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050630"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050630"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050631"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050630"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">{--------------------------------------------------------------------
  Query
--------------------------------------------------------------------}</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | /O(1)/. Is the map empty?</span><span>
</span><span id="line-60"></span><span id="local-6989586621679050628"><span id="local-6989586621679050629"><span class="annot"><a href="Data.Dependent.Map.Internal.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050629"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050628"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-61"></span><span id="null"><span class="annot"><span class="annottext">null :: DMap k f -&gt; Bool
</span><a href="Data.Dependent.Map.Internal.html#null"><span class="hs-identifier hs-var hs-var">null</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | /O(1)/. The number of elements in the map.</span><span>
</span><span id="line-65"></span><span id="local-6989586621679050759"><span id="local-6989586621679050760"><span class="annot"><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050760"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050759"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-66"></span><span id="size"><span class="annot"><span class="annottext">size :: DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span id="local-6989586621679050625"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050625"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050625"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | /O(log n)/. Lookup the value at a key in the map.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- The function will return the corresponding value as @('Just' value)@,</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- or 'Nothing' if the key isn't in the map.</span><span>
</span><span id="line-73"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679050623"><span class="annot"><a href="#local-6989586621679050623"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679050622"><span class="annot"><a href="#local-6989586621679050622"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679050621"><span class="annot"><a href="#local-6989586621679050621"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="annot"><a href="#local-6989586621679050623"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050623"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050621"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050623"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050621"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span id="lookup"><span class="annot"><span class="annottext">lookup :: k v -&gt; DMap k f -&gt; Maybe (f v)
</span><a href="Data.Dependent.Map.Internal.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679050620"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050620"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050620"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; (DMap k f -&gt; Maybe (f v)) -&gt; DMap k f -&gt; Maybe (f v)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Maybe (f v)
</span><a href="#local-6989586621679050619"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><a href="#local-6989586621679050619"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050623"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050622"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050621"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621679050619"><span class="annot"><span class="annottext">go :: DMap k f -&gt; Maybe (f v)
</span><a href="#local-6989586621679050619"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (f v)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><a href="#local-6989586621679050619"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050618"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050618"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050617"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050617"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050616"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050616"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050615"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050615"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k v -&gt; k v -&gt; GOrdering v v
forall k (f :: k -&gt; *) (a :: k) (b :: k).
GCompare f =&gt;
f a -&gt; f b -&gt; GOrdering a b
</span><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050620"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050618"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-80"></span><span>                </span><span class="annot"><span class="annottext">GOrdering v v
</span><span class="hs-identifier hs-var">GLT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Maybe (f v)
</span><a href="#local-6989586621679050619"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050616"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-81"></span><span>                </span><span class="annot"><span class="annottext">GOrdering v v
</span><span class="hs-identifier hs-var">GGT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Maybe (f v)
</span><a href="#local-6989586621679050619"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050615"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-82"></span><span>                </span><span class="annot"><span class="annottext">GOrdering v v
</span><span class="hs-identifier hs-var">GEQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f v -&gt; Maybe (f v)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050617"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#lookupAssoc"><span class="hs-identifier hs-type">lookupAssoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679050658"><span class="annot"><a href="#local-6989586621679050658"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679050657"><span class="annot"><a href="#local-6989586621679050657"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679050656"><span class="annot"><a href="#local-6989586621679050656"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="annot"><a href="#local-6989586621679050658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Some</span></span><span> </span><span class="annot"><a href="#local-6989586621679050658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050657"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050657"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span id="lookupAssoc"><span class="annot"><span class="annottext">lookupAssoc :: Some k -&gt; DMap k f -&gt; Maybe (DSum k f)
</span><a href="Data.Dependent.Map.Internal.html#lookupAssoc"><span class="hs-identifier hs-var hs-var">lookupAssoc</span></a></span></span><span> </span><span id="local-6989586621679050610"><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050610"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Some k
-&gt; (forall (a :: k). k a -&gt; DMap k f -&gt; Maybe (DSum k f))
-&gt; DMap k f
-&gt; Maybe (DSum k f)
forall k (tag :: k -&gt; *) b.
Some tag -&gt; (forall (a :: k). tag a -&gt; b) -&gt; b
</span><span class="hs-identifier hs-var">withSome</span></span><span> </span><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050610"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (a :: k). k a -&gt; DMap k f -&gt; Maybe (DSum k f))
 -&gt; DMap k f -&gt; Maybe (DSum k f))
-&gt; (forall (a :: k). k a -&gt; DMap k f -&gt; Maybe (DSum k f))
-&gt; DMap k f
-&gt; Maybe (DSum k f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679050609"><span class="annot"><span class="annottext">k a
</span><a href="#local-6989586621679050609"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="#local-6989586621679050608"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050657"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050658"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050657"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679050608"><span class="annot"><span class="annottext">go :: DMap k f -&gt; Maybe (DSum k f)
</span><a href="#local-6989586621679050608"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (DSum k f)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="#local-6989586621679050608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050607"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050607"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050606"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050606"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050605"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050605"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050604"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050604"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k a -&gt; k v -&gt; GOrdering a v
forall k (f :: k -&gt; *) (a :: k) (b :: k).
GCompare f =&gt;
f a -&gt; f b -&gt; GOrdering a b
</span><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><span class="annottext">k a
</span><a href="#local-6989586621679050609"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050607"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-91"></span><span>            </span><span class="annot"><span class="annottext">GOrdering a v
</span><span class="hs-identifier hs-var">GLT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Maybe (DSum k f)
</span><a href="#local-6989586621679050608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050605"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-92"></span><span>            </span><span class="annot"><span class="annottext">GOrdering a v
</span><span class="hs-identifier hs-var">GGT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Maybe (DSum k f)
</span><a href="#local-6989586621679050608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050604"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-93"></span><span>            </span><span class="annot"><span class="annottext">GOrdering a v
</span><span class="hs-identifier hs-var">GEQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DSum k f -&gt; Maybe (DSum k f)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050607"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DSum k f
forall k (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050606"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">k a
</span><a href="#local-6989586621679050609"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k a
-&gt; (DMap k f -&gt; Maybe (DSum k f)) -&gt; DMap k f -&gt; Maybe (DSum k f)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Maybe (DSum k f)
</span><a href="#local-6989586621679050608"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">{--------------------------------------------------------------------
  Utility functions that maintain the balance properties of the tree.
  All constructors assume that all values in [l] &lt; [k] and all values
  in [r] &gt; [k], and that [l] and [r] are valid trees.

  In order of sophistication:
    [Bin sz k x l r]  The type constructor.
    [bin k x l r]     Maintains the correct size, assumes that both [l]
                      and [r] are balanced with respect to each other.
    [balance k x l r] Restores the balance and size.
                      Assumes that the original tree was balanced and
                      that [l] or [r] has changed by at most one element.
    [combine k x l r] Restores balance and size.

  Furthermore, we can construct a new tree from two trees. Both operations
  assume that all values in [l] &lt; all values in [r] and that [l] and [r]
  are valid:
    [glue l r]        Glues [l] and [r] together. Assumes that [l] and
                      [r] are already balanced with respect to each other.
    [merge l r]       Merges two trees and restores balance.

  Note: in contrast to Adam's paper, we use (&lt;=) comparisons instead
  of (&lt;) comparisons in [combine], [merge] and [balance].
  Quickcheck (on [difference]) showed that this was necessary in order
  to maintain the invariants. It is quite unsatisfactory that I haven't
  been able to find out why this is actually the case! Fortunately, it
  doesn't hurt to be a bit more conservative.
--------------------------------------------------------------------}</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">{--------------------------------------------------------------------
  Combine
--------------------------------------------------------------------}</span><span>
</span><span id="line-128"></span><span id="local-6989586621679050787"><span id="local-6989586621679050788"><span id="local-6989586621679050789"><span class="annot"><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="annot"><a href="#local-6989586621679050789"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050789"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050788"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050787"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050788"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050789"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050787"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050789"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050787"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050789"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050787"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-129"></span><span id="combine"><span class="annot"><span class="annottext">combine :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679050602"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050602"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050601"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050601"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span id="local-6989586621679050600"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050600"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#insertMin"><span class="hs-identifier hs-var">insertMin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050602"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050601"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050600"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span id="local-6989586621679050598"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050598"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050597"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050597"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050596"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050596"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#insertMax"><span class="hs-identifier hs-var">insertMax</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050598"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050597"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050596"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span id="local-6989586621679050594"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050594"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050593"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050593"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050592"><span class="annot"><span class="annottext">l :: DMap k f
</span><a href="#local-6989586621679050592"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span id="local-6989586621679050591"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050591"><span class="hs-identifier hs-var">sizeL</span></a></span></span><span> </span><span id="local-6989586621679050590"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050590"><span class="hs-identifier hs-var">ky</span></a></span></span><span> </span><span id="local-6989586621679050589"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050589"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679050588"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050588"><span class="hs-identifier hs-var">ly</span></a></span></span><span> </span><span id="local-6989586621679050587"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050587"><span class="hs-identifier hs-var">ry</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050586"><span class="annot"><span class="annottext">r :: DMap k f
</span><a href="#local-6989586621679050586"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span id="local-6989586621679050585"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050585"><span class="hs-identifier hs-var">sizeR</span></a></span></span><span> </span><span id="local-6989586621679050584"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050584"><span class="hs-identifier hs-var">kz</span></a></span></span><span> </span><span id="local-6989586621679050583"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050583"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679050582"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050582"><span class="hs-identifier hs-var">lz</span></a></span></span><span> </span><span id="local-6989586621679050581"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050581"><span class="hs-identifier hs-var">rz</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050591"><span class="hs-identifier hs-var">sizeL</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050585"><span class="hs-identifier hs-var">sizeR</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050584"><span class="hs-identifier hs-var">kz</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050583"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
GCompare k =&gt;
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050594"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050593"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050592"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050582"><span class="hs-identifier hs-var">lz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050581"><span class="hs-identifier hs-var">rz</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050585"><span class="hs-identifier hs-var">sizeR</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050591"><span class="hs-identifier hs-var">sizeL</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050590"><span class="hs-identifier hs-var">ky</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050589"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050588"><span class="hs-identifier hs-var">ly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
GCompare k =&gt;
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050594"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050593"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050587"><span class="hs-identifier hs-var">ry</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050586"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050594"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050593"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050592"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050586"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- insertMin and insertMax don't perform potentially expensive comparisons.</span><span>
</span><span id="line-138"></span><span id="local-6989586621679050799"><span id="local-6989586621679050800"><span id="local-6989586621679050801"><span class="annot"><a href="Data.Dependent.Map.Internal.html#insertMax"><span class="hs-identifier hs-type">insertMax</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#insertMin"><span class="hs-identifier hs-type">insertMin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050801"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050800"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050799"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050800"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050801"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050799"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050801"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050799"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-139"></span><span id="insertMax"><span class="annot"><span class="annottext">insertMax :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#insertMax"><span class="hs-identifier hs-var hs-var">insertMax</span></a></span></span><span> </span><span id="local-6989586621679050575"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050575"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050574"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050574"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050573"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050573"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050573"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050575"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050574"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050572"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050572"><span class="hs-identifier hs-var">ky</span></a></span></span><span> </span><span id="local-6989586621679050571"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050571"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679050570"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050570"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050569"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050569"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050572"><span class="hs-identifier hs-var">ky</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050571"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050570"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#insertMax"><span class="hs-identifier hs-var">insertMax</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050575"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050574"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050569"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="insertMin"><span class="annot"><span class="annottext">insertMin :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#insertMin"><span class="hs-identifier hs-var hs-var">insertMin</span></a></span></span><span> </span><span id="local-6989586621679050568"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050568"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050567"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050567"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050566"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050566"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050566"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-147"></span><span>      </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050568"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050567"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050565"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050565"><span class="hs-identifier hs-var">ky</span></a></span></span><span> </span><span id="local-6989586621679050564"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050564"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679050563"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050563"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050562"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050562"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-149"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050565"><span class="hs-identifier hs-var">ky</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050564"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#insertMin"><span class="hs-identifier hs-var">insertMin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050568"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050567"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050563"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050562"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">{--------------------------------------------------------------------
  [merge l r]: merges two trees.
--------------------------------------------------------------------}</span><span>
</span><span id="line-154"></span><span id="local-6989586621679050765"><span id="local-6989586621679050766"><span class="annot"><a href="Data.Dependent.Map.Internal.html#merge"><span class="hs-identifier hs-type">merge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050766"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050765"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050766"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050765"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050766"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050765"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-155"></span><span id="merge"><span class="annot"><span class="annottext">merge :: DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#merge"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span id="local-6989586621679050560"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050560"><span class="hs-identifier hs-var">r</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050560"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span id="local-6989586621679050559"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050559"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050559"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span id="local-6989586621679050558"><span class="annot"><span class="annottext">l :: DMap k f
</span><a href="#local-6989586621679050558"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span id="local-6989586621679050557"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050557"><span class="hs-identifier hs-var">sizeL</span></a></span></span><span> </span><span id="local-6989586621679050556"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050556"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050555"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050555"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050554"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050554"><span class="hs-identifier hs-var">lx</span></a></span></span><span> </span><span id="local-6989586621679050553"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050553"><span class="hs-identifier hs-var">rx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050552"><span class="annot"><span class="annottext">r :: DMap k f
</span><a href="#local-6989586621679050552"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span id="local-6989586621679050551"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050551"><span class="hs-identifier hs-var">sizeR</span></a></span></span><span> </span><span id="local-6989586621679050550"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050550"><span class="hs-identifier hs-var">ky</span></a></span></span><span> </span><span id="local-6989586621679050549"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050549"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679050548"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050548"><span class="hs-identifier hs-var">ly</span></a></span></span><span> </span><span id="local-6989586621679050547"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050547"><span class="hs-identifier hs-var">ry</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050557"><span class="hs-identifier hs-var">sizeL</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050551"><span class="hs-identifier hs-var">sizeR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050550"><span class="hs-identifier hs-var">ky</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050549"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *).
DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050558"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050548"><span class="hs-identifier hs-var">ly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050547"><span class="hs-identifier hs-var">ry</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050551"><span class="hs-identifier hs-var">sizeR</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050557"><span class="hs-identifier hs-var">sizeL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050556"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050555"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050554"><span class="hs-identifier hs-var">lx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *).
DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050553"><span class="hs-identifier hs-var">rx</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050552"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *).
DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#glue"><span class="hs-identifier hs-var">glue</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050558"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050552"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">{--------------------------------------------------------------------
  [glue l r]: glues two trees together.
  Assumes that [l] and [r] are already balanced with respect to each other.
--------------------------------------------------------------------}</span><span>
</span><span id="line-166"></span><span id="local-6989586621679050544"><span id="local-6989586621679050545"><span class="annot"><a href="Data.Dependent.Map.Internal.html#glue"><span class="hs-identifier hs-type">glue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050545"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050544"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050545"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050544"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050545"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050544"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-167"></span><span id="glue"><span class="annot"><span class="annottext">glue :: DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#glue"><span class="hs-identifier hs-var hs-var">glue</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span id="local-6989586621679050543"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050543"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050543"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#glue"><span class="hs-identifier hs-var">glue</span></a></span><span> </span><span id="local-6989586621679050542"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050542"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050542"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#glue"><span class="hs-identifier hs-var">glue</span></a></span><span> </span><span id="local-6989586621679050541"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050541"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050540"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050540"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050541"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050540"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; (DSum k f, DMap k f)
forall k (k :: k -&gt; *) (f :: k -&gt; *).
DMap k f -&gt; (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#deleteFindMax"><span class="hs-identifier hs-var">deleteFindMax</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050541"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050537"><span class="annot"><span class="annottext">k a
</span><a href="#local-6989586621679050537"><span class="hs-identifier hs-var">km</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:=&gt;</span></span><span> </span><span id="local-6989586621679050536"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679050536"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050535"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050535"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k a -&gt; f a -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k a
</span><a href="#local-6989586621679050537"><span class="hs-identifier hs-var">km</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679050536"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050535"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050540"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; (DSum k f, DMap k f)
forall k (k :: k -&gt; *) (f :: k -&gt; *).
DMap k f -&gt; (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#deleteFindMin"><span class="hs-identifier hs-var">deleteFindMin</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050540"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050533"><span class="annot"><span class="annottext">k a
</span><a href="#local-6989586621679050533"><span class="hs-identifier hs-var">km</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:=&gt;</span></span><span> </span><span id="local-6989586621679050532"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679050532"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050531"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050531"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k a -&gt; f a -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k a
</span><a href="#local-6989586621679050533"><span class="hs-identifier hs-var">km</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679050532"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050541"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050531"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | /O(log n)/. Delete and find the minimal element.</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- &gt; deleteFindMin (fromList [(5,&quot;a&quot;), (3,&quot;b&quot;), (10,&quot;c&quot;)]) == ((3,&quot;b&quot;), fromList[(5,&quot;a&quot;), (10,&quot;c&quot;)])</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- &gt; deleteFindMin                                            Error: can not return the minimal element of an empty map</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span id="local-6989586621679050529"><span id="local-6989586621679050530"><span class="annot"><a href="Data.Dependent.Map.Internal.html#deleteFindMin"><span class="hs-identifier hs-type">deleteFindMin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050530"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050529"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050530"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050529"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050530"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050529"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-179"></span><span id="deleteFindMin"><span class="annot"><span class="annottext">deleteFindMin :: DMap k f -&gt; (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#deleteFindMin"><span class="hs-identifier hs-var hs-var">deleteFindMin</span></a></span></span><span> </span><span id="local-6989586621679050528"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050528"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Maybe (DSum k f, DMap k f)
forall k (k :: k -&gt; *) (f :: k -&gt; *).
DMap k f -&gt; Maybe (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#minViewWithKey"><span class="hs-identifier hs-var">minViewWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050528"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">Maybe (DSum k f, DMap k f)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; DSum k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Map.deleteFindMin: can not return the minimal element of an empty map&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679050525"><span class="annot"><span class="annottext">(DSum k f, DMap k f)
</span><a href="#local-6989586621679050525"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(DSum k f, DMap k f)
</span><a href="#local-6989586621679050525"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | A strict pair.</span><span>
</span><span id="line-184"></span><span class="hs-keyword">data</span><span> </span><span id="%3A%2A%3A"><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-var">(:*:)</span></a></span></span><span> </span><span id="local-6989586621679050729"><span class="annot"><a href="#local-6989586621679050729"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679050728"><span class="annot"><a href="#local-6989586621679050728"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679050729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span id="%3A%2A%3A"><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679050728"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-185"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-type hs-type">:*:</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Convert a strict pair to a pair.</span><span>
</span><span id="line-188"></span><span id="local-6989586621679050732"><span id="local-6989586621679050733"><span class="annot"><a href="Data.Dependent.Map.Internal.html#toPair"><span class="hs-identifier hs-type">toPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050733"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050732"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050733"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679050732"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-189"></span><span id="toPair"><span class="annot"><span class="annottext">toPair :: (a :*: b) -&gt; (a, b)
</span><a href="Data.Dependent.Map.Internal.html#toPair"><span class="hs-identifier hs-var hs-var">toPair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050522"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050522"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span id="local-6989586621679050521"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679050521"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050522"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679050521"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#toPair"><span class="hs-pragma hs-type">toPair</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">data</span><span> </span><span id="Triple%27"><span class="annot"><a href="Data.Dependent.Map.Internal.html#Triple%27"><span class="hs-identifier hs-var">Triple'</span></a></span></span><span> </span><span id="local-6989586621679050520"><span class="annot"><a href="#local-6989586621679050520"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679050519"><span class="annot"><a href="#local-6989586621679050519"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679050518"><span class="annot"><a href="#local-6989586621679050518"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Triple%27"><span class="annot"><a href="Data.Dependent.Map.Internal.html#Triple%27"><span class="hs-identifier hs-var">Triple'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679050520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679050519"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679050518"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Convert a strict triple to a triple.</span><span>
</span><span id="line-195"></span><span id="local-6989586621679050514"><span id="local-6989586621679050515"><span id="local-6989586621679050516"><span class="annot"><a href="Data.Dependent.Map.Internal.html#toTriple"><span class="hs-identifier hs-type">toTriple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Triple%27"><span class="hs-identifier hs-type">Triple'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050516"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050515"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050514"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050516"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679050515"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679050514"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-196"></span><span id="toTriple"><span class="annot"><span class="annottext">toTriple :: Triple' a b c -&gt; (a, b, c)
</span><a href="Data.Dependent.Map.Internal.html#toTriple"><span class="hs-identifier hs-var hs-var">toTriple</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Triple%27"><span class="hs-identifier hs-type">Triple'</span></a></span><span> </span><span id="local-6989586621679050512"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050512"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679050511"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679050511"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679050510"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679050510"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050512"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679050511"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679050510"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#toTriple"><span class="hs-pragma hs-type">toTriple</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | /O(log n)/. Retrieves the minimal (key :=&gt; value) entry of the map, and</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- the map stripped of that element, or 'Nothing' if passed an empty map.</span><span>
</span><span id="line-201"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#minViewWithKey"><span class="hs-identifier hs-type">minViewWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679050749"><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679050748"><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span id="minViewWithKey"><span class="annot"><span class="annottext">minViewWithKey :: DMap k f -&gt; Maybe (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#minViewWithKey"><span class="hs-identifier hs-var hs-var">minViewWithKey</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (DSum k f, DMap k f)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#minViewWithKey"><span class="hs-identifier hs-var">minViewWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050509"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050509"><span class="hs-identifier hs-var">k0</span></a></span></span><span> </span><span id="local-6989586621679050508"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050508"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679050507"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050507"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span id="local-6989586621679050506"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050506"><span class="hs-identifier hs-var">r0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DSum k f, DMap k f) -&gt; Maybe (DSum k f, DMap k f)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((DSum k f, DMap k f) -&gt; Maybe (DSum k f, DMap k f))
-&gt; (DSum k f, DMap k f) -&gt; Maybe (DSum k f, DMap k f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">(DSum k f :*: DMap k f) -&gt; (DSum k f, DMap k f)
forall a b. (a :*: b) -&gt; (a, b)
</span><a href="Data.Dependent.Map.Internal.html#toPair"><span class="hs-identifier hs-var">toPair</span></a></span><span> </span><span class="annot"><span class="annottext">((DSum k f :*: DMap k f) -&gt; (DSum k f, DMap k f))
-&gt; (DSum k f :*: DMap k f) -&gt; (DSum k f, DMap k f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall (v :: k).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
</span><a href="#local-6989586621679050504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050509"><span class="hs-identifier hs-var">k0</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050508"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050507"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050506"><span class="hs-identifier hs-var">r0</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679050731"><span class="annot"><a href="#local-6989586621679050504"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050731"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050731"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050748"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679050504"><span class="annot"><span class="annottext">go :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
</span><a href="#local-6989586621679050504"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679050503"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050503"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050502"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050502"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span id="local-6989586621679050501"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050501"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050503"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DSum k f
forall k (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050502"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DSum k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall a b. a -&gt; b -&gt; a :*: b
</span><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050501"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="#local-6989586621679050504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679050500"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050500"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050499"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050499"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050498"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050498"><span class="hs-identifier hs-var">kl</span></a></span></span><span> </span><span id="local-6989586621679050497"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050497"><span class="hs-identifier hs-var">xl</span></a></span></span><span> </span><span id="local-6989586621679050496"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050496"><span class="hs-identifier hs-var">ll</span></a></span></span><span> </span><span id="local-6989586621679050495"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050495"><span class="hs-identifier hs-var">lr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050494"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050494"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679050493"><span class="annot"><span class="annottext">DSum k f
</span><a href="#local-6989586621679050493"><span class="hs-identifier hs-var">km</span></a></span></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span id="local-6989586621679050492"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050492"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall (v :: k).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
</span><a href="#local-6989586621679050504"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050498"><span class="hs-identifier hs-var">kl</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050497"><span class="hs-identifier hs-var">xl</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050496"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050495"><span class="hs-identifier hs-var">lr</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DSum k f
</span><a href="#local-6989586621679050493"><span class="hs-identifier hs-var">km</span></a></span><span> </span><span class="annot"><span class="annottext">DSum k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall a b. a -&gt; b -&gt; a :*: b
</span><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050500"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050499"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050492"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050494"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | /O(log n)/. Retrieves the maximal (key :=&gt; value) entry of the map, and</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- the map stripped of that element, or 'Nothing' if passed an empty map.</span><span>
</span><span id="line-213"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#maxViewWithKey"><span class="hs-identifier hs-type">maxViewWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679050490"><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679050489"><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span id="maxViewWithKey"><span class="annot"><span class="annottext">maxViewWithKey :: DMap k f -&gt; Maybe (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#maxViewWithKey"><span class="hs-identifier hs-var hs-var">maxViewWithKey</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (DSum k f, DMap k f)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#maxViewWithKey"><span class="hs-identifier hs-var">maxViewWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050488"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050488"><span class="hs-identifier hs-var">k0</span></a></span></span><span> </span><span id="local-6989586621679050487"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050487"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679050486"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050486"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span id="local-6989586621679050485"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050485"><span class="hs-identifier hs-var">r0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DSum k f, DMap k f) -&gt; Maybe (DSum k f, DMap k f)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((DSum k f, DMap k f) -&gt; Maybe (DSum k f, DMap k f))
-&gt; (DSum k f, DMap k f) -&gt; Maybe (DSum k f, DMap k f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">(DSum k f :*: DMap k f) -&gt; (DSum k f, DMap k f)
forall a b. (a :*: b) -&gt; (a, b)
</span><a href="Data.Dependent.Map.Internal.html#toPair"><span class="hs-identifier hs-var">toPair</span></a></span><span> </span><span class="annot"><span class="annottext">((DSum k f :*: DMap k f) -&gt; (DSum k f, DMap k f))
-&gt; (DSum k f :*: DMap k f) -&gt; (DSum k f, DMap k f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall (v :: k).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
</span><a href="#local-6989586621679050484"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050488"><span class="hs-identifier hs-var">k0</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050487"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050486"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050485"><span class="hs-identifier hs-var">r0</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679050722"><span class="annot"><a href="#local-6989586621679050484"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050722"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050722"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050490"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050489"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679050484"><span class="annot"><span class="annottext">go :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
</span><a href="#local-6989586621679050484"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679050483"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050483"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050482"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050482"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050481"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050481"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050483"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DSum k f
forall k (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050482"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DSum k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall a b. a -&gt; b -&gt; a :*: b
</span><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050481"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="#local-6989586621679050484"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679050480"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050480"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050479"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050479"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050478"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050478"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050477"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050477"><span class="hs-identifier hs-var">kr</span></a></span></span><span> </span><span id="local-6989586621679050476"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050476"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679050475"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050475"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span id="local-6989586621679050474"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050474"><span class="hs-identifier hs-var">rr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679050473"><span class="annot"><span class="annottext">DSum k f
</span><a href="#local-6989586621679050473"><span class="hs-identifier hs-var">km</span></a></span></span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-type">:*:</span></a></span><span> </span><span id="local-6989586621679050472"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050472"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall (v :: k).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
</span><a href="#local-6989586621679050484"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050477"><span class="hs-identifier hs-var">kr</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050476"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050475"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050474"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DSum k f
</span><a href="#local-6989586621679050473"><span class="hs-identifier hs-var">km</span></a></span><span> </span><span class="annot"><span class="annottext">DSum k f -&gt; DMap k f -&gt; DSum k f :*: DMap k f
forall a b. a -&gt; b -&gt; a :*: b
</span><a href="Data.Dependent.Map.Internal.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050480"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050479"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050478"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050472"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | /O(log n)/. Delete and find the maximal element.</span><span>
</span><span id="line-224"></span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- &gt; deleteFindMax (fromList [(5,&quot;a&quot;), (3,&quot;b&quot;), (10,&quot;c&quot;)]) == ((10,&quot;c&quot;), fromList [(3,&quot;b&quot;), (5,&quot;a&quot;)])</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- &gt; deleteFindMax empty                                      Error: can not return the maximal element of an empty map</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621679050756"><span id="local-6989586621679050757"><span class="annot"><a href="Data.Dependent.Map.Internal.html#deleteFindMax"><span class="hs-identifier hs-type">deleteFindMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050757"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050756"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050757"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050756"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050757"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050756"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-229"></span><span id="deleteFindMax"><span class="annot"><span class="annottext">deleteFindMax :: DMap k f -&gt; (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#deleteFindMax"><span class="hs-identifier hs-var hs-var">deleteFindMax</span></a></span></span><span> </span><span id="local-6989586621679050471"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050471"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050471"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050470"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050470"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050469"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050469"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050468"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050468"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050470"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DSum k f
forall k (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050469"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050468"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050467"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050467"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050466"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050466"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050465"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050465"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050464"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050464"><span class="hs-identifier hs-var">r</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050463"><span class="annot"><span class="annottext">DSum k f
</span><a href="#local-6989586621679050463"><span class="hs-identifier hs-var">km</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050462"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050462"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; (DSum k f, DMap k f)
forall k (k :: k -&gt; *) (f :: k -&gt; *).
DMap k f -&gt; (DSum k f, DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#deleteFindMax"><span class="hs-identifier hs-var">deleteFindMax</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050464"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DSum k f
</span><a href="#local-6989586621679050463"><span class="hs-identifier hs-var">km</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050467"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050466"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050465"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050462"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; DSum k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Map.deleteFindMax: can not return the maximal element of an empty map&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">{--------------------------------------------------------------------
  [balance l x r] balances two trees with value x.
  The sizes of the trees should balance after decreasing the
  size of one of them. (a rotation).

  [delta] is the maximal relative difference between the sizes of
          two trees, it corresponds with the [w] in Adams' paper.
  [ratio] is the ratio between an outer and inner sibling of the
          heavier subtree in an unbalanced setting. It determines
          whether a double or single rotation should be performed
          to restore balance. It corresponds with the inverse
          of $\alpha$ in Adam's article.

  Note that:
  - [delta] should be larger than 4.646 with a [ratio] of 2.
  - [delta] should be larger than 3.745 with a [ratio] of 1.534.

  - A lower [delta] leads to a more 'perfectly' balanced tree.
  - A higher [delta] performs less rebalancing.

  - Balancing is automatic for random data and a balancing
    scheme is only necessary to avoid pathological worst cases.
    Almost any choice will do, and in practice, a rather large
    [delta] may perform better than smaller one.

  Note: in contrast to Adam's paper, we use a ratio of (at least) [2]
  to decide whether a single or double rotation is needed. Although
  he actually proves that this ratio is needed to maintain the
  invariants, his implementation uses an invalid ratio of [1].
--------------------------------------------------------------------}</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#ratio"><span class="hs-identifier hs-type">ratio</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-267"></span><span id="delta"><span class="annot"><span class="annottext">delta :: Int
</span><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-268"></span><span id="ratio"><span class="annot"><span class="annottext">ratio :: Int
</span><a href="Data.Dependent.Map.Internal.html#ratio"><span class="hs-identifier hs-var hs-var">ratio</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621679050791"><span id="local-6989586621679050792"><span id="local-6989586621679050793"><span class="annot"><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-type">balance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050793"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050792"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050791"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050792"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050793"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050791"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050793"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050791"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050793"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050791"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-271"></span><span id="balance"><span class="annot"><span class="annottext">balance :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#balance"><span class="hs-identifier hs-var hs-var">balance</span></a></span></span><span> </span><span id="local-6989586621679050460"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050460"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050459"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050459"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050458"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050458"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050457"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050457"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050456"><span class="hs-identifier hs-var">sizeL</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050454"><span class="hs-identifier hs-var">sizeR</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050453"><span class="hs-identifier hs-var">sizeX</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050460"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050459"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050458"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050457"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050454"><span class="hs-identifier hs-var">sizeR</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050456"><span class="hs-identifier hs-var">sizeL</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#rotateL"><span class="hs-identifier hs-var">rotateL</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050460"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050459"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050458"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050457"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050456"><span class="hs-identifier hs-var">sizeL</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#delta"><span class="hs-identifier hs-var">delta</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050454"><span class="hs-identifier hs-var">sizeR</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#rotateR"><span class="hs-identifier hs-var">rotateR</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050460"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050459"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050458"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050457"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050453"><span class="hs-identifier hs-var">sizeX</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050460"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050459"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050458"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050457"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679050456"><span class="annot"><span class="annottext">sizeL :: Int
</span><a href="#local-6989586621679050456"><span class="hs-identifier hs-var hs-var">sizeL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050458"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621679050454"><span class="annot"><span class="annottext">sizeR :: Int
</span><a href="#local-6989586621679050454"><span class="hs-identifier hs-var hs-var">sizeR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050457"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679050453"><span class="annot"><span class="annottext">sizeX :: Int
</span><a href="#local-6989586621679050453"><span class="hs-identifier hs-var hs-var">sizeX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050456"><span class="hs-identifier hs-var">sizeL</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050454"><span class="hs-identifier hs-var">sizeR</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- rotate</span><span>
</span><span id="line-282"></span><span id="local-6989586621679050448"><span id="local-6989586621679050449"><span id="local-6989586621679050450"><span class="annot"><a href="Data.Dependent.Map.Internal.html#rotateL"><span class="hs-identifier hs-type">rotateL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050450"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050449"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050448"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050449"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050450"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050448"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050450"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050448"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050450"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050448"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-283"></span><span id="rotateL"><span class="annot"><span class="annottext">rotateL :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#rotateL"><span class="hs-identifier hs-var hs-var">rotateL</span></a></span></span><span> </span><span id="local-6989586621679050447"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050447"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050446"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050446"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050445"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050445"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050444"><span class="annot"><span class="annottext">r :: DMap k f
</span><a href="#local-6989586621679050444"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050443"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050443"><span class="hs-identifier hs-var">ly</span></a></span></span><span> </span><span id="local-6989586621679050442"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050442"><span class="hs-identifier hs-var">ry</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050443"><span class="hs-identifier hs-var">ly</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#ratio"><span class="hs-identifier hs-var">ratio</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050442"><span class="hs-identifier hs-var">ry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#singleL"><span class="hs-identifier hs-var">singleL</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050447"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050446"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050445"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050444"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#doubleL"><span class="hs-identifier hs-var">doubleL</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050447"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050446"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050445"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050444"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#rotateL"><span class="hs-identifier hs-var">rotateL</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DMap k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;rotateL Tip&quot;</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span id="local-6989586621679050436"><span id="local-6989586621679050437"><span id="local-6989586621679050438"><span class="annot"><a href="Data.Dependent.Map.Internal.html#rotateR"><span class="hs-identifier hs-type">rotateR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050438"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050437"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050436"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050437"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050438"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050436"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050438"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050436"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050438"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050436"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-289"></span><span id="rotateR"><span class="annot"><span class="annottext">rotateR :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#rotateR"><span class="hs-identifier hs-var hs-var">rotateR</span></a></span></span><span> </span><span id="local-6989586621679050435"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050435"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050434"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050434"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050433"><span class="annot"><span class="annottext">l :: DMap k f
</span><a href="#local-6989586621679050433"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050432"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050432"><span class="hs-identifier hs-var">ly</span></a></span></span><span> </span><span id="local-6989586621679050431"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050431"><span class="hs-identifier hs-var">ry</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050430"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050430"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050431"><span class="hs-identifier hs-var">ry</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Dependent.Map.Internal.html#ratio"><span class="hs-identifier hs-var">ratio</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050432"><span class="hs-identifier hs-var">ly</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#singleR"><span class="hs-identifier hs-var">singleR</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050435"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050434"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050433"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050430"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#doubleR"><span class="hs-identifier hs-var">doubleR</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050435"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050434"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050433"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050430"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#rotateR"><span class="hs-identifier hs-var">rotateR</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DMap k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;rotateR Tip&quot;</span></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- basic rotations</span><span>
</span><span id="line-295"></span><span id="local-6989586621679050425"><span id="local-6989586621679050426"><span id="local-6989586621679050427"><span class="annot"><a href="Data.Dependent.Map.Internal.html#singleL"><span class="hs-identifier hs-type">singleL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#singleR"><span class="hs-identifier hs-type">singleR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050426"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050426"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050425"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-296"></span><span id="singleL"><span class="annot"><span class="annottext">singleL :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#singleL"><span class="hs-identifier hs-var hs-var">singleL</span></a></span></span><span> </span><span id="local-6989586621679050424"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050424"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679050423"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050423"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679050422"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050422"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050421"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050421"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679050420"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050420"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679050419"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050419"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679050418"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050418"><span class="hs-identifier hs-var">t3</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050421"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050420"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050424"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050423"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050422"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050419"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050418"><span class="hs-identifier hs-var">t3</span></a></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#singleL"><span class="hs-identifier hs-var">singleL</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DMap k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;singleL Tip&quot;</span></span><span>
</span><span id="line-298"></span><span id="singleR"><span class="annot"><span class="annottext">singleR :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#singleR"><span class="hs-identifier hs-var hs-var">singleR</span></a></span></span><span> </span><span id="local-6989586621679050417"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050417"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679050416"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050416"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050415"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050415"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679050414"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050414"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679050413"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050413"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679050412"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050412"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050411"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050411"><span class="hs-identifier hs-var">t3</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050415"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050414"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050413"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050417"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050416"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050412"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050411"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#singleR"><span class="hs-identifier hs-var">singleR</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DMap k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;singleR Tip&quot;</span></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span id="local-6989586621679050408"><span id="local-6989586621679050409"><span id="local-6989586621679050410"><span class="annot"><a href="Data.Dependent.Map.Internal.html#doubleL"><span class="hs-identifier hs-type">doubleL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#doubleR"><span class="hs-identifier hs-type">doubleR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050410"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050409"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050408"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050409"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050410"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050408"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050410"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050408"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050410"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050408"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-302"></span><span id="doubleL"><span class="annot"><span class="annottext">doubleL :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#doubleL"><span class="hs-identifier hs-var hs-var">doubleL</span></a></span></span><span> </span><span id="local-6989586621679050407"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050407"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679050406"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050406"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679050405"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050405"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050404"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050404"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679050403"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050403"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050402"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050402"><span class="hs-identifier hs-var">k3</span></a></span></span><span> </span><span id="local-6989586621679050401"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050401"><span class="hs-identifier hs-var">x3</span></a></span></span><span> </span><span id="local-6989586621679050400"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050400"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679050399"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050399"><span class="hs-identifier hs-var">t3</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050398"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050398"><span class="hs-identifier hs-var">t4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050402"><span class="hs-identifier hs-var">k3</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050401"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050407"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050406"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050405"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050400"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050404"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050403"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050399"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050398"><span class="hs-identifier hs-var">t4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#doubleL"><span class="hs-identifier hs-var">doubleL</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DMap k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;doubleL&quot;</span></span><span>
</span><span id="line-304"></span><span id="doubleR"><span class="annot"><span class="annottext">doubleR :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#doubleR"><span class="hs-identifier hs-var hs-var">doubleR</span></a></span></span><span> </span><span id="local-6989586621679050397"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050397"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679050396"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050396"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050395"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050395"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621679050394"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050394"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679050393"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050393"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050392"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050392"><span class="hs-identifier hs-var">k3</span></a></span></span><span> </span><span id="local-6989586621679050391"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050391"><span class="hs-identifier hs-var">x3</span></a></span></span><span> </span><span id="local-6989586621679050390"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050390"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679050389"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050389"><span class="hs-identifier hs-var">t3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679050388"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050388"><span class="hs-identifier hs-var">t4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050392"><span class="hs-identifier hs-var">k3</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050391"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050395"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050394"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050393"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050390"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050397"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050396"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050389"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050388"><span class="hs-identifier hs-var">t4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#doubleR"><span class="hs-identifier hs-var">doubleR</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DMap k f
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;doubleR&quot;</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">{--------------------------------------------------------------------
  The bin constructor maintains the size of the tree
--------------------------------------------------------------------}</span><span>
</span><span id="line-310"></span><span id="local-6989586621679050385"><span id="local-6989586621679050386"><span id="local-6989586621679050387"><span class="annot"><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050387"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050386"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050385"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050386"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050387"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050385"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050387"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050385"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050387"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050385"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-311"></span><span id="bin"><span class="annot"><span class="annottext">bin :: k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#bin"><span class="hs-identifier hs-var hs-var">bin</span></a></span></span><span> </span><span id="local-6989586621679050384"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050384"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679050383"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050383"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050382"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050382"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050381"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050381"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
Int -&gt; k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050382"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; Int
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f -&gt; Int
</span><a href="Data.Dependent.Map.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050381"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050384"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050383"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050382"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050381"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">{--------------------------------------------------------------------
  Utility functions that return sub-ranges of the original
  tree. Some functions take a comparison function as argument to
  allow comparisons against infinite values. A function [cmplo k]
  should be read as [compare lo k].

  [trim cmplo cmphi t]  A tree that is either empty or where [cmplo k == LT]
                        and [cmphi k == GT] for the key [k] of the root.
  [filterGt cmp t]      A tree where for all keys [k]. [cmp k == LT]
  [filterLt cmp t]      A tree where for all keys [k]. [cmp k == GT]

  [split k t]           Returns two trees [l] and [r] where all keys
                        in [l] are &lt;[k] and all keys in [r] are &gt;[k].
  [splitLookup k t]     Just like [split] but also returns whether [k]
                        was found in the tree.
--------------------------------------------------------------------}</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">{--------------------------------------------------------------------
  [trim lo hi t] trims away all subtrees that surely contain no
  values between the range [lo] to [hi]. The returned tree is either
  empty or the key of the root is between @lo@ and @hi@.
--------------------------------------------------------------------}</span><span>
</span><span id="line-336"></span><span id="local-6989586621679050665"><span id="local-6989586621679050666"><span class="annot"><a href="Data.Dependent.Map.Internal.html#trim"><span class="hs-identifier hs-type">trim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Some</span></span><span> </span><span class="annot"><a href="#local-6989586621679050666"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Some</span></span><span> </span><span class="annot"><a href="#local-6989586621679050666"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050666"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050665"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050666"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050665"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-337"></span><span id="trim"><span class="annot"><span class="annottext">trim :: (Some k -&gt; Ordering)
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#trim"><span class="hs-identifier hs-var hs-var">trim</span></a></span></span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><span class="hs-identifier">_</span></span><span>     </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><span class="hs-identifier">_</span></span><span>     </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#trim"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span id="local-6989586621679050379"><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050379"><span class="hs-identifier hs-var">cmplo</span></a></span></span><span> </span><span id="local-6989586621679050378"><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050378"><span class="hs-identifier hs-var">cmphi</span></a></span></span><span> </span><span id="local-6989586621679050377"><span class="annot"><span class="annottext">t :: DMap k f
</span><a href="#local-6989586621679050377"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050376"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050376"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span class="annot"><span class="annottext">f v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050375"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050375"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050374"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050374"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050379"><span class="hs-identifier hs-var">cmplo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; Some k
forall k (tag :: k -&gt; *) (a :: k). tag a -&gt; Some tag
</span><span class="hs-identifier hs-var">mkSome</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050376"><span class="hs-identifier hs-var">kx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050378"><span class="hs-identifier hs-var">cmphi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; Some k
forall k (tag :: k -&gt; *) (a :: k). tag a -&gt; Some tag
</span><span class="hs-identifier hs-var">mkSome</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050376"><span class="hs-identifier hs-var">kx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-341"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050377"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-342"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Some k -&gt; Ordering)
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *).
(Some k -&gt; Ordering)
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#trim"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050379"><span class="hs-identifier hs-var">cmplo</span></a></span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050378"><span class="hs-identifier hs-var">cmphi</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050375"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Some k -&gt; Ordering)
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *).
(Some k -&gt; Ordering)
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#trim"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050379"><span class="hs-identifier hs-var">cmplo</span></a></span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050378"><span class="hs-identifier hs-var">cmphi</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050374"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621679050653"><span id="local-6989586621679050654"><span class="annot"><a href="Data.Dependent.Map.Internal.html#trimLookupLo"><span class="hs-identifier hs-type">trimLookupLo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="annot"><a href="#local-6989586621679050654"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Some</span></span><span> </span><span class="annot"><a href="#local-6989586621679050654"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Some</span></span><span> </span><span class="annot"><a href="#local-6989586621679050654"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050654"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050653"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSum</span></span><span> </span><span class="annot"><a href="#local-6989586621679050654"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050653"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050654"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050653"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-346"></span><span id="trimLookupLo"><span class="annot"><span class="annottext">trimLookupLo :: Some k
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; (Maybe (DSum k f), DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#trimLookupLo"><span class="hs-identifier hs-var hs-var">trimLookupLo</span></a></span></span><span> </span><span class="annot"><span class="annottext">Some k
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><span class="hs-identifier">_</span></span><span>     </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (DSum k f)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span class="annot"><a href="Data.Dependent.Map.Internal.html#trimLookupLo"><span class="hs-identifier hs-var">trimLookupLo</span></a></span><span> </span><span id="local-6989586621679050372"><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050372"><span class="hs-identifier hs-var">lo</span></a></span></span><span> </span><span id="local-6989586621679050371"><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050371"><span class="hs-identifier hs-var">cmphi</span></a></span></span><span> </span><span id="local-6989586621679050370"><span class="annot"><span class="annottext">t :: DMap k f
</span><a href="#local-6989586621679050370"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050369"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050369"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050368"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050368"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050367"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050367"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050366"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050366"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Some k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050372"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; Some k
forall k (tag :: k -&gt; *) (a :: k). tag a -&gt; Some tag
</span><span class="hs-identifier hs-var">mkSome</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050369"><span class="hs-identifier hs-var">kx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050371"><span class="hs-identifier hs-var">cmphi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; Some k
forall k (tag :: k -&gt; *) (a :: k). tag a -&gt; Some tag
</span><span class="hs-identifier hs-var">mkSome</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050369"><span class="hs-identifier hs-var">kx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-350"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some k -&gt; DMap k f -&gt; Maybe (DSum k f)
forall k k (k :: k -&gt; *) (f :: k -&gt; *) (v :: k).
GCompare k =&gt;
Some k -&gt; DMap k f -&gt; Maybe (DSum k f)
</span><a href="Data.Dependent.Map.Internal.html#lookupAssoc"><span class="hs-identifier hs-var">lookupAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050372"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050370"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050370"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Some k
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; (Maybe (DSum k f), DMap k f)
forall k (k :: k -&gt; *) (f :: k -&gt; *).
GCompare k =&gt;
Some k
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; (Maybe (DSum k f), DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#trimLookupLo"><span class="hs-identifier hs-var">trimLookupLo</span></a></span><span> </span><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050372"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050371"><span class="hs-identifier hs-var">cmphi</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050367"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Some k
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; (Maybe (DSum k f), DMap k f)
forall k (k :: k -&gt; *) (f :: k -&gt; *).
GCompare k =&gt;
Some k
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; (Maybe (DSum k f), DMap k f)
</span><a href="Data.Dependent.Map.Internal.html#trimLookupLo"><span class="hs-identifier hs-var">trimLookupLo</span></a></span><span> </span><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050372"><span class="hs-identifier hs-var">lo</span></a></span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050371"><span class="hs-identifier hs-var">cmphi</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050366"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-353"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DSum k f -&gt; Maybe (DSum k f)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050369"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DSum k f
forall k (tag :: k -&gt; *) (f :: k -&gt; *) (a :: k).
tag a -&gt; f a -&gt; DSum tag f
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050368"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Some k -&gt; Ordering)
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *).
(Some k -&gt; Ordering)
-&gt; (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#trim"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Some k -&gt; Some k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Some k
</span><a href="#local-6989586621679050372"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050371"><span class="hs-identifier hs-var">cmphi</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050366"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">{--------------------------------------------------------------------
  [filterGt k t] filter all keys &gt;[k] from tree [t]
  [filterLt k t] filter all keys &lt;[k] from tree [t]
--------------------------------------------------------------------}</span><span>
</span><span id="line-360"></span><span id="local-6989586621679050363"><span id="local-6989586621679050364"><span class="annot"><a href="Data.Dependent.Map.Internal.html#filterGt"><span class="hs-identifier hs-type">filterGt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="annot"><a href="#local-6989586621679050364"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Some</span></span><span> </span><span class="annot"><a href="#local-6989586621679050364"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050364"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050364"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-361"></span><span id="filterGt"><span class="annot"><span class="annottext">filterGt :: (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#filterGt"><span class="hs-identifier hs-var hs-var">filterGt</span></a></span></span><span> </span><span id="local-6989586621679050361"><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050361"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050360"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621679050360"><span class="annot"><span class="annottext">go :: DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050360"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><a href="#local-6989586621679050360"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050359"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050359"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050358"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050358"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050357"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050357"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050356"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050356"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050361"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; Some k
forall k (tag :: k -&gt; *) (a :: k). tag a -&gt; Some tag
</span><span class="hs-identifier hs-var">mkSome</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050359"><span class="hs-identifier hs-var">kx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-365"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
GCompare k =&gt;
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050359"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050358"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050360"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050357"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-366"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050360"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-367"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050356"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span id="local-6989586621679050354"><span id="local-6989586621679050355"><span class="annot"><a href="Data.Dependent.Map.Internal.html#filterLt"><span class="hs-identifier hs-type">filterLt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="annot"><a href="#local-6989586621679050355"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Some</span></span><span> </span><span class="annot"><a href="#local-6989586621679050355"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050355"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050354"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Dependent.Map.Internal.html#DMap"><span class="hs-identifier hs-type">DMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050355"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050354"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-370"></span><span id="filterLt"><span class="annot"><span class="annottext">filterLt :: (Some k -&gt; Ordering) -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#filterLt"><span class="hs-identifier hs-var hs-var">filterLt</span></a></span></span><span> </span><span id="local-6989586621679050352"><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050352"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050351"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621679050351"><span class="annot"><span class="annottext">go :: DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050351"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DMap k f
forall k (k :: k -&gt; *) (f :: k -&gt; *). DMap k f
</span><a href="Data.Dependent.Map.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Dependent.Map.Internal.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050350"><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050350"><span class="hs-identifier hs-var">kx</span></a></span></span><span> </span><span id="local-6989586621679050349"><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050349"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679050348"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050348"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679050347"><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050347"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Some k -&gt; Ordering
</span><a href="#local-6989586621679050352"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k v -&gt; Some k
forall k (tag :: k -&gt; *) (a :: k). tag a -&gt; Some tag
</span><span class="hs-identifier hs-var">mkSome</span></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050350"><span class="hs-identifier hs-var">kx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-374"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050351"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050348"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-375"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
forall k (k :: k -&gt; *) (v :: k) (f :: k -&gt; *).
GCompare k =&gt;
k v -&gt; f v -&gt; DMap k f -&gt; DMap k f -&gt; DMap k f
</span><a href="Data.Dependent.Map.Internal.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">k v
</span><a href="#local-6989586621679050350"><span class="hs-identifier hs-var">kx</span></a></span><span> </span><span class="annot"><span class="annottext">f v
</span><a href="#local-6989586621679050349"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050348"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMap k f -&gt; DMap k f
</span><a href="#local-6989586621679050351"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050347"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DMap k f
</span><a href="#local-6989586621679050348"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-377"></span></pre></body></html>